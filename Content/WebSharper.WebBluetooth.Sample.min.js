(function(n){"use strict";Date.now||(Date.now=function(){return(new Date).getTime()});Math.trunc||(Math.trunc=function(n){return n<0?Math.ceil(n):Math.floor(n)});Object.setPrototypeOf||(Object.setPrototypeOf=function(n,t){return n.__proto__=t,n});n.WebSharper={Runtime:{Ctor:function(n,t){return n.prototype=t.prototype,n},Class:function(n,t,i){var u=n,f,r,e;if(t){u=new t;for(f in n)u[f]=n[f]}if(r=function(n){if(n)for(var t in n)this[t]=n[t]},r.prototype=u,i)for(e in i)r[e]=i[e];return r},Clone:function(n){var t={};for(var i of Object.getOwnPropertyNames(n))t[i]=n[i];return Object.setPrototypeOf(t,Object.getPrototypeOf(n)),t},NewObject:function(n){for(var i={},t=0;t<n.length;t++)i[n[t][0]]=n[t][1];return i},PrintObject:function(n){var t="{ ",i=!0;for(var r of Object.getOwnPropertyNames(n))i?i=!1:t+=", ",t+=r+" = "+n[r];return t+(i?"}":" }")},DeleteEmptyFields:function(n,t){for(var r,i=0;i<t.length;i++)r=t[i],n[r]===void 0&&delete n[r];return n},GetOptional:function(n){return n===void 0?null:{$:1,$0:n}},SetOptional:function(n,t,i){i?n[t]=i.$0:delete n[t]},SetOrDelete:function(n,t,i){i===void 0?delete n[t]:n[t]=i},Apply:function(n,t,i){return n.apply(t,i)},Bind:function(n){return function(){return n.apply(this,arguments)}},CreateFuncWithArgs:function(n){return function(){return n(Array.prototype.slice.call(arguments))}},CreateFuncWithOnlyThis:function(n){return function(){return n(this)}},CreateFuncWithThis:function(n){return function(){return n(this).apply(null,arguments)}},CreateFuncWithThisArgs:function(n){return function(){return n(this)(Array.prototype.slice.call(arguments))}},CreateFuncWithRest:function(n,t){return function(){return t(Array.prototype.slice.call(arguments,0,n).concat([Array.prototype.slice.call(arguments,n)]))}},CreateFuncWithArgsRest:function(n,t){return function(){return t([Array.prototype.slice.call(arguments,0,n),Array.prototype.slice.call(arguments,n)])}},BindDelegate:function(n,t){var i=n.bind(t);return i.$Func=n,i.$Target=t,i},CreateDelegate:function(n){if(n.length==0)return null;if(n.length==1)return n[0];var t=function(){for(var i,t=0;t<n.length;t++)i=n[t].apply(null,arguments);return i};return t.$Invokes=n,t},CombineDelegates:function(n){for(var t,i=[],r=0;r<n.length;r++)t=n[r],t&&("$Invokes"in t?i=i.concat(t.$Invokes):i.push(t));return WebSharper.Runtime.CreateDelegate(i)},DelegateEqual:function(n,t){var f,e,i,r,u;if(n===t)return!0;if(n==null||t==null||(f=n.$Invokes||[n],e=t.$Invokes||[t],f.length!=e.length))return!1;for(i=0;i<f.length;i++)if(r=f[i],u=e[i],!(r===u||"$Func"in r&&"$Func"in u&&r.$Func===u.$Func&&r.$Target==u.$Target))return!1;return!0},ThisFunc:function(n){return function(){var t=Array.prototype.slice.call(arguments);return t.unshift(this),n.apply(null,t)}},ThisFuncOut:function(n){return function(){var t=Array.prototype.slice.call(arguments);return n.apply(t.shift(),t)}},ParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat([i.slice(n)]))}},ParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat(i[n]))}},ThisParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return i.unshift(this),t.apply(null,i.slice(0,n+1).concat([i.slice(n+1)]))}},ThisParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(i.shift(),i.slice(0,n).concat(i[n]))}},Curried:function(n,t,i){return i=i||[],function(r){var u=i.concat([r===void 0?null:r]);return t==1?n.apply(null,u):t==2?function(t){return n.apply(null,u.concat([t===void 0?null:t]))}:WebSharper.Runtime.Curried(n,t-1,u)}},Curried2:function(n){return function(t){return function(i){return n(t,i)}}},Curried3:function(n){return function(t){return function(i){return function(r){return n(t,i,r)}}}},UnionByType:function(n,t,i){for(var u,f=typeof t,r=0;r<n.length;r++)if(u=n[r],typeof u=="number"){if(Array.isArray(t)&&(u==0||t.length==u))return{$:r,$0:t}}else if(u==f)return{$:r,$0:t};if(!i)throw new Error("Type not expected for creating Choice value.");},MarkResizable:function(n){return Object.defineProperty(n,"resizable",{enumerable:!1,writable:!1,configurable:!1,value:!0}),n},MarkReadOnly:function(n){return Object.defineProperty(n,"readonly",{enumerable:!1,writable:!1,configurable:!1,value:!0}),n},ScriptBasePath:"./",ScriptPath:function(n,t){return this.ScriptBasePath+(this.ScriptSkipAssemblyDir?"":n+"/")+t},OnLoad:function(n){"load"in this||(this.load=[]);this.load.push(n)},Start:function(){function n(n){for(var t=0;t<n.length;t++)n[t]()}"load"in this&&(n(this.load),this.load=[])}}};n.WebSharper.Runtime.OnLoad(function(){n.WebSharper&&WebSharper.Activator&&WebSharper.Activator.Activate&&WebSharper.Activator.Activate()});n.ignore=function(){};n.id=function(n){return n};n.fst=function(n){return n[0]};n.snd=function(n){return n[1]};n.trd=function(n){return n[2]};n.console||(n.console={count:ignore,dir:ignore,error:ignore,group:ignore,groupEnd:ignore,info:ignore,log:ignore,profile:ignore,profileEnd:ignore,time:ignore,timeEnd:ignore,trace:ignore,warn:ignore})})(self);
/* https://github.com/jonathantneal/closest */
(function(w,p){p=w.Element.prototype
if(!p.matches){p.matches=p.msMatchesSelector||function(s){var m=(this.document||this.ownerDocument).querySelectorAll(s);for(var i=0;m[i]&&m[i]!==e;++i);return!!m[i]}}
if(!p.closest){p.closest=function(s){var e=this;while(e&&e.nodeType==1){if(e.matches(s))return e;e=e.parentNode}return null}}})(self);
(function(){for(var i=0,t=["webkit","moz"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(n){var t=(new Date).getTime(),r=Math.max(0,16-(t-i)),u=window.setTimeout(function(){n(t+r)},r);return i=t+r,u});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(n){clearTimeout(n)})})();
(function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_,$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY,bZ,b0,b1,b2,b3,b4,b5,b6,b7,b8,b9,b_,b$,ca;b=a.WebSharper=a.WebSharper||{};c=b.WebBluetooth=b.WebBluetooth||{};d=c.Sample=c.Sample||{};e=d.Client=d.Client||{};f=b.Operators=b.Operators||{};g=b.Obj=b.Obj||{};h=b.UI=b.UI||{};i=h.Templating=h.Templating||{};j=i.Runtime=i.Runtime||{};k=j.Server=j.Server||{};l=k.TemplateInstance=k.TemplateInstance||{};m=b.Arrays=b.Arrays||{};n=k.ProviderBuilder=k.ProviderBuilder||{};o=h.TemplateHole=h.TemplateHole||{};p=h.Var=h.Var||{};q=k.Handler=k.Handler||{};r=b.Unchecked=b.Unchecked||{};s=a.WebSharper$WebBluetooth$Sample_Templates=a.WebSharper$WebBluetooth$Sample_Templates||{};t=h.TemplateHoleModule=h.TemplateHoleModule||{};u=t.Text=t.Text||{};v=t.TextView=t.TextView||{};w=a.StartupCode$WebSharper_WebBluetooth_Sample$Client=a.StartupCode$WebSharper_WebBluetooth_Sample$Client||{};x=a.System=a.System||{};y=x.Guid=x.Guid||{};z=t.EventQ=t.EventQ||{};A=b.JavaScript=b.JavaScript||{};B=A.Pervasives=A.Pervasives||{};C=b.Concurrency=b.Concurrency||{};D=A.Promise=A.Promise||{};E=a.EventTarget;F=b.Utils=b.Utils||{};G=h.Client=h.Client||{};H=G.Templates=G.Templates||{};I=h.Doc=h.Doc||{};J=b.Collections=b.Collections||{};K=J.Dictionary=J.Dictionary||{};L=a.Node;M=a.Object;N=h.Var$1=h.Var$1||{};O=a.WindowOrWorkerGlobalScope;P=A.JS=A.JS||{};Q=C.AsyncBody=C.AsyncBody||{};R=C.CT=C.CT||{};S=J.HashSet=J.HashSet||{};T=b.Seq=b.Seq||{};U=k.TemplateInitializer=k.TemplateInitializer||{};V=t.VarStr=t.VarStr||{};W=t.VarFloatUnchecked=t.VarFloatUnchecked||{};X=t.VarBool=t.VarBool||{};Y=t.VarDateTime=t.VarDateTime||{};Z=t.VarFile=t.VarFile||{};_0=t.VarDomElement=t.VarDomElement||{};_1=h.View=h.View||{};_2=b.Numeric=b.Numeric||{};_3=h.ConcreteVar=h.ConcreteVar||{};_4=h.Snap=h.Snap||{};_5=C.Scheduler=C.Scheduler||{};_6=a.Error;_7=A.NonStandardPromiseRejectionException=A.NonStandardPromiseRejectionException||{};_8=a.StartupCode$WebSharper_Main$Concurrency=a.StartupCode$WebSharper_Main$Concurrency||{};_9=J.DictionaryUtil=J.DictionaryUtil||{};_=b.Enumerator=b.Enumerator||{};$=_.T=_.T||{};ba=a.StartupCode$WebSharper_UI$Templates=a.StartupCode$WebSharper_UI$Templates||{};bb=h.Docs=h.Docs||{};bc=h.DocElemNode=h.DocElemNode||{};bd=a.CharacterData;be=h.Abbrev=h.Abbrev||{};bf=be.Fresh=be.Fresh||{};bg=b.OperationCanceledException=b.OperationCanceledException||{};bh=b.CancellationTokenSource=b.CancellationTokenSource||{};bi=a.Blob;bj=h.Elt=h.Elt||{};bk=a.Element;bl=H.Prepare=H.Prepare||{};bm=b.Slice=b.Slice||{};bn=h.DomUtility=h.DomUtility||{};bo=J.KeyCollection=J.KeyCollection||{};bp=h.An=h.An||{};bq=G.Settings=G.Settings||{};br=be.Mailbox=be.Mailbox||{};bs=G.Attrs=G.Attrs||{};bt=bs.Dyn=bs.Dyn||{};bu=h.Attrs=h.Attrs||{};bv=t.Elt=t.Elt||{};bw=t.Attribute=t.Attribute||{};bx=t.Event=t.Event||{};by=h.AttrModule=h.AttrModule||{};bz=h.AttrProxy=h.AttrProxy||{};bA=t.AfterRender=t.AfterRender||{};bB=t.AfterRenderQ=t.AfterRenderQ||{};bC=b.List=b.List||{};bD=bC.T=bC.T||{};bE=b.Strings=b.Strings||{};bF=h.Array=h.Array||{};bG=h.Updates=h.Updates||{};bH=J.ValueCollection=J.ValueCollection||{};bI=G.Docs=G.Docs||{};bJ=bI.RunState=bI.RunState||{};bK=bI.NodeSet=bI.NodeSet||{};bL=h.Anims=h.Anims||{};bM=a.StartupCode$WebSharper_UI$Doc_Proxy=a.StartupCode$WebSharper_UI$Doc_Proxy||{};bN=J.HashSetUtil=J.HashSetUtil||{};bO=a.StartupCode$WebSharper_UI$Abbrev=a.StartupCode$WebSharper_UI$Abbrev||{};bP=a.StartupCode$WebSharper_UI$DomUtility=a.StartupCode$WebSharper_UI$DomUtility||{};bQ=a.StartupCode$WebSharper_UI$Animation=a.StartupCode$WebSharper_UI$Animation||{};bR=h.AppendList=h.AppendList||{};bS=h.DynamicAttrNode=h.DynamicAttrNode||{};bT=b.KeyNotFoundException=b.KeyNotFoundException||{};bU=a.StartupCode$WebSharper_UI$Attr_Client=a.StartupCode$WebSharper_UI$Attr_Client||{};bV=h.Easing=h.Easing||{};bW=be.HashSet=be.HashSet||{};bX=h.BindVar=h.BindVar||{};bY=h.String=h.String||{};bZ=h.CheckedInput=h.CheckedInput||{};b0=bI.DomNodes=bI.DomNodes||{};b1=b.Char=b.Char||{};b2=b.DateUtil=b.DateUtil||{};b3=b.Lazy=b.Lazy||{};b4=a.StartupCode$WebSharper_UI$AppendList=a.StartupCode$WebSharper_UI$AppendList||{};b5=b.Queue=b.Queue||{};b6=b.LazyExtensionsProxy=b.LazyExtensionsProxy||{};b7=b6.LazyRecord=b6.LazyRecord||{};b8=a.console;b9=a.Promise;b_=b&&b.Runtime;b$=a.Math;ca=a.Date;e.Main=function(){var cb,cc,cd,ce,cf,cg;cb=(cc=(cd=(ce=new n.New$1(),(ce.h.push(q.EventQ2(ce.k,"connectbluetooth",function(){return ce.i;},function(){var ch;C.Start((ch=null,C.Delay(function(){return C.Bind(D.AsAsync(e.connectBluetooth()),function(){return C.Return(null);});})),null);})),ce)),(cd.h.push(new v.New("status",e.statusMessage().get_View())),cd)),(cf=q.CompleteHoles(cc.k,cc.h,[]),(cg=new l.New(cf[1],s.main(cf[0])),cc.i=cg,cg))).get_Doc();H.LoadLocalTemplates("");I.RunById("main",cb);};e.statusMessage=function(){w.$cctor();return w.statusMessage;};e.connectBluetooth=function(){var cb;function cc(){function cd(){var cf;return e.bluetooth().requestDevice((cf={},cf.acceptAllDevices=true,cf.optionalServices=["battery_service"],cf)).then(function(cg){var ch;ch=cg.name==null?"Unknown Device":cg.name;e.statusMessage().Set("Connected to: "+a.String(ch));b8.log("Device Info:",cg);return cg.gatt.connect().then(function(ci){b8.log("Connected to GATT Server!");return ci.getPrimaryService("battery_service").then(function(cj){return cj.getCharacteristic("battery_level").then(function(ck){return D.OfAsync(D.AsAsync(ck.readValue())).then(function(cl){var cm;cm=cl.getUint8(0);e.statusMessage().Set(F.toSafe(e.statusMessage().Get())+" - Battery: "+a.String(cm)+"%");return b9.resolve(null);});});});});});}function ce(cf){b8.error("Bluetooth Connection Failed:",cf.message);e.statusMessage().Set("Bluetooth connection failed!");return b9.resolve(null);}return new b9(function(cf){cf(cd());})["catch"](function(cf){return ce(D.unwrapExn(cf));});}cb=null;return new b9(function(cd){cd(cc());});};e.bluetooth=function(){w.$cctor();return w.bluetooth;};f.FailWith=function(cb){throw new _6(cb);};f.KeyValue=function(cb){return[cb.K,cb.V];};f.range=function(cb,cc){var cd;cd=1+cc-cb;return cd<=0?[]:T.init(cd,function(ce){return ce+cb;});};g=b.Obj=b_.Class({Equals:function(cb){return this===cb;},GetHashCode:function(){return -1;}},null,g);g.New=b_.Ctor(function(){},g);l=k.TemplateInstance=b_.Class({get_Doc:function(){return this.doc;},SetAnchorRoot:function(cb){this.anchorRoot=cb;}},g,l);l.New=b_.Ctor(function(cb,cc){g.New.call(this);this.doc=cc;this.allVars=cb.$==0?cb.$0:f.FailWith("Should not happen");this.anchorRoot=null;},l);m.get=function(cb,cc){m.checkBounds(cb,cc);return cb[cc];};m.length=function(cb){return cb.dims===2?cb.length*cb.length:cb.length;};m.checkBounds=function(cb,cc){if(cc<0||cc>=cb.length)f.FailWith("Index was outside the bounds of the array.");};m.set=function(cb,cc,cd){m.checkBounds(cb,cc);cb[cc]=cd;};n=k.ProviderBuilder=b_.Class({},g,n);n.New$1=b_.Ctor(function(){var cb;g.New.call(this);this.i=null;this.k=(cb=y.NewGuid(),a.String(cb));this.h=b_.MarkResizable([]);b_.SetOptional(this,"s",null);},n);o=h.TemplateHole=b_.Class({ForTextView:function(){b8.warn("Content hole filled with attribute data",this.get_Name());return null;},AddAttribute:function(cb,cc){b8.warn("Var hole filled with non-Var data",this.get_Name());},get_AsChoiceView:function(){b8.warn("Attribute value hole filled with non-text data",this.get_Name());return{$:0,$0:""};}},g,o);o.New=b_.Ctor(function(){g.New.call(this);},o);p=h.Var=b_.Class({},g,p);p.New=b_.Ctor(function(){g.New.call(this);},p);q.EventQ2=function(cb,cc,cd,ce){return new z.New(cc,function(cf){return function(cg){var ch;ch=cd();ch.SetAnchorRoot(cf);return ce({Vars:ch,Anchors:ch,Target:cf,Event:cg});};});};q.CompleteHoles=function(cb,cc,cd){var cf,cg,ch,ci,cj;function ce(ck,cl,cm){var cn;return cg.Contains(ck)?null:(cn=r.Equals(cl,0)?U.GetOrAddHoleFor(cb,ck,function(){return new V.New(ck,N.Create$1(""));}):r.Equals(cl,1)?U.GetOrAddHoleFor(cb,ck,function(){return new W.New(ck,N.Create$1(0));}):r.Equals(cl,2)?U.GetOrAddHoleFor(cb,ck,function(){return new X.New(ck,N.Create$1(false));}):r.Equals(cl,3)?U.GetOrAddHoleFor(cb,ck,function(){return new Y.New(ck,N.Create$1(-8640000000000000));}):r.Equals(cl,4)?U.GetOrAddHoleFor(cb,ck,function(){return new Z.New(ck,N.Create$1([]));}):r.Equals(cl,5)?U.GetOrAddHoleFor(cb,ck,function(){var co;co=self.document.querySelector("[ws-dom="+ck+"]");co.removeAttribute("ws-dom");return new _0.New(ck,N.Create$1({$:1,$0:co}));}):f.FailWith("Invalid value type"),(cf.set_Item(ck,cn),{$:1,$0:cn}));}cf=new K.New$5();cg=new S.New$3();ch=_.Get(cc);try{while(ch.MoveNext()){ci=ch.Current();cj=ci.get_Name();cg.SAdd(cj);cf.set_Item(cj,ci);}}finally{if(typeof ch=="object"&&"Dispose"in ch)ch.Dispose();}return[T.append(cc,m.choose(function(ck){return ce(ck[0],ck[1],ck[2]);},cd)),{$:0,$0:cf}];};r.Equals=function(cb,cc){var cd,ce,cf,cg;if(cb===cc)return true;else{cd=typeof cb;if(cd=="object"){if(cb===null||cb===void 0||cc===null||cc===void 0||!r.Equals(typeof cc,"object"))return false;else if("Equals"in cb)return cb.Equals(cc);else if("Equals"in cc)return false;else if(cb instanceof a.Array&&cc instanceof a.Array)return r.arrayEquals(cb,cc);else if(cb instanceof a.Date&&cc instanceof a.Date)return r.dateEquals(cb,cc);else{ce=[true];for(var ch in cb)if(function(ci){ce[0]=!cb.hasOwnProperty(ci)||cc.hasOwnProperty(ci)&&r.Equals(cb[ci],cc[ci]);return!ce[0];}(ch))break;if(ce[0]){for(var ci in cc)if(function(cj){ce[0]=!cc.hasOwnProperty(cj)||cb.hasOwnProperty(cj);return!ce[0];}(ci))break;}return ce[0];}}else return cd=="function"&&("$Func"in cb?cb.$Func===cc.$Func&&cb.$Target===cc.$Target:"$Invokes"in cb&&"$Invokes"in cc&&r.arrayEquals(cb.$Invokes,cc.$Invokes));}};r.arrayEquals=function(cb,cc){var cd,ce;if(m.length(cb)===m.length(cc)){cd=true;ce=0;while(cd&&ce<m.length(cb)){!r.Equals(m.get(cb,ce),m.get(cc,ce))?cd=false:void 0;ce=ce+1;}return cd;}else return false;};r.dateEquals=function(cb,cc){return cb.getTime()===cc.getTime();};r.Hash=function(cb){var cc;cc=typeof cb;return cc=="function"?0:cc=="boolean"?cb?1:0:cc=="number"?cb:cc=="string"?r.hashString(cb):cc=="object"?cb==null?0:cb instanceof a.Array?r.hashArray(cb):r.hashObject(cb):0;};r.hashString=function(cb){var cc,cd,ce;if(cb===null)return 0;else{cc=5381;for(cd=0,ce=cb.length-1;cd<=ce;cd++)cc=r.hashMix(cc,cb[cd].charCodeAt());return cc;}};r.hashArray=function(cb){var cc,cd,ce;cc=-34948909;for(cd=0,ce=m.length(cb)-1;cd<=ce;cd++)cc=r.hashMix(cc,r.Hash(m.get(cb,cd)));return cc;};r.hashObject=function(cb){var cc,cd;if("GetHashCode"in cb)return cb.GetHashCode();else{cc=[0];for(var ce in cb)if(function(cf){cc[0]=r.hashMix(r.hashMix(cc[0],r.hashString(cf)),r.Hash(cb[cf]));return false;}(ce))break;return cc[0];}};r.hashMix=function(cb,cc){return(cb<<5)+cb+cc;};r.Compare=function(cb,cc){var cd,ce,cf,cg,ch,ci;if(cb===cc)return 0;else{ce=typeof cb;switch(ce=="function"?1:ce=="boolean"?2:ce=="number"?2:ce=="string"?2:ce=="object"?3:0){case 0:return typeof cc=="undefined"?0:-1;case 1:return f.FailWith("Cannot compare function values.");case 2:return cb<cc?-1:1;case 3:if(cb===null)cf=-1;else if(cc===null)cf=1;else if("CompareTo"in cb)cf=cb.CompareTo(cc);else if("CompareTo0"in cb)cf=cb.CompareTo0(cc);else if(cb instanceof a.Array&&cc instanceof a.Array)cf=r.compareArrays(cb,cc);else if(cb instanceof a.Date&&cc instanceof a.Date)cf=r.compareDates(cb,cc);else{cg=[0];for(var cj in cb)if(function(ck){return!cb.hasOwnProperty(ck)?false:!cc.hasOwnProperty(ck)?(cg[0]=1,true):(cg[0]=r.Compare(cb[ck],cc[ck]),cg[0]!==0);}(cj))break;if(cg[0]===0){for(var ck in cc)if(function(cl){return!cc.hasOwnProperty(cl)?false:!cb.hasOwnProperty(cl)&&(cg[0]=-1,true);}(ck))break;}cf=cg[0];}return cf;}}};r.compareArrays=function(cb,cc){var cd,ce;if(m.length(cb)<m.length(cc))return -1;else if(m.length(cb)>m.length(cc))return 1;else{cd=0;ce=0;while(cd===0&&ce<m.length(cb)){cd=r.Compare(m.get(cb,ce),m.get(cc,ce));ce=ce+1;}return cd;}};r.compareDates=function(cb,cc){return r.Compare(cb.getTime(),cc.getTime());};s.main=function(cb){H.LoadLocalTemplates("index");return cb?H.NamedTemplate("index",{$:1,$0:"main"},cb):void 0;};u=t.Text=b_.Class({get_Name:function(){return this.name;},get_Value:function(){return this.fillWith;},get_AsChoiceView:function(){return{$:0,$0:this.fillWith};}},o,u);u.New=b_.Ctor(function(cb,cc){o.New.call(this);this.name=cb;this.fillWith=cc;},u);v=t.TextView=b_.Class({get_Name:function(){return this.name;},ForTextView:function(){return{$:1,$0:this.fillWith};},get_AsChoiceView:function(){return{$:1,$0:this.fillWith};}},o,v);v.New=b_.Ctor(function(cb,cc){o.New.call(this);this.name=cb;this.fillWith=cc;},v);w.$cctor=function(){w.$cctor=a.ignore;w.statusMessage=N.Create$1("Click the button to connect Bluetooth.");w.bluetooth=self.navigator.bluetooth;};y.NewGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(new a.RegExp("[xy]","g"),function(cb){var cc,cd;cc=b$.random()*16|0;cd=cb=="x"?cc:cc&3|8;return cd.toString(16);});};z=t.EventQ=b_.Class({get_Name:function(){return this.name;},get_Value:function(){return this.fillWith;}},o,z);z.New=b_.Ctor(function(cb,cc){o.New.call(this);this.name=cb;this.fillWith=cc;},z);B.NewFromSeq=function(cb){var cc,cd,ce;cc={};cd=_.Get(cb);try{while(cd.MoveNext()){ce=cd.Current();cc[ce[0]]=ce[1];}}finally{if(typeof cd=="object"&&"Dispose"in cd)cd.Dispose();}return cc;};C.Delay=function(cb){return function(cc){try{(cb(null))(cc);}catch(cd){cc.k({$:1,$0:cd});}};};C.Bind=function(cb,cc){return C.checkCancel(function(cd){cb(Q.New(function(ce){var cf;if(ce.$==0){cf=ce.$0;C.scheduler().Fork(function(){try{(cc(cf))(cd);}catch(cg){cd.k({$:1,$0:cg});}});}else C.scheduler().Fork(function(){cd.k(ce);});},cd.ct));});};C.Return=function(cb){return function(cc){cc.k({$:0,$0:cb});};};C.Start=function(cb,cc){var cd,ce;cd=(ce=(C.defCTS())[0],cc==null?ce:cc.$0);C.scheduler().Fork(function(){if(!cd.c)cb(Q.New(function(cf){if(cf.$==1)C.UncaughtAsyncError(cf.$0);},cd));});};C.checkCancel=function(cb){return function(cc){if(cc.ct.c)C.cancel(cc);else cb(cc);};};C.defCTS=function(){_8.$cctor();return _8.defCTS;};C.UncaughtAsyncError=function(cb){b8.log("WebSharper: Uncaught asynchronous exception",cb);};C.cancel=function(cb){cb.k({$:2,$0:new bg.New(cb.ct)});};C.scheduler=function(){_8.$cctor();return _8.scheduler;};C.FromContinuations=function(cb){return function(cc){var cd;function ce(cf){if(cd[0])f.FailWith("A continuation provided by Async.FromContinuations was invoked multiple times");else{cd[0]=true;C.scheduler().Fork(cf);}}cd=[false];cb(function(cf){ce(function(){cc.k({$:0,$0:cf});});},function(cf){ce(function(){cc.k({$:1,$0:cf});});},function(cf){ce(function(){cc.k({$:2,$0:cf});});});};};C.StartWithContinuations=function(cb,cc,cd,ce,cf){var cg,ch;cg=(ch=(C.defCTS())[0],cf==null?ch:cf.$0);if(!cg.c)cb(Q.New(function(ci){if(ci.$==1)cd(ci.$0);else if(ci.$==2)ce(ci.$0);else cc(ci.$0);},cg));};C.Zero=function(){_8.$cctor();return _8.Zero;};D.AsAsync=function(cb){return C.FromContinuations(function(cc,cd){cb.then(cc,function(ce){return cd(D.unwrapExn(ce));});});};D.unwrapExn=function(cb){return cb instanceof _6?cb:new _7.New(cb);};D.OfAsync=function(cb){return new b9(function(cc,cd){C.StartWithContinuations(cb,cc,function(ce){cd(ce);},function(ce){cd(ce);},null);});};F.toSafe=function(cb){return cb==null?"":cb;};H.LoadLocalTemplates=function(cb){!H.LocalTemplatesLoaded()?(H.set_LocalTemplatesLoaded(true),H.LoadNestedTemplates(self.document.body,"")):void 0;H.LoadedTemplates().set_Item(cb,H.LoadedTemplateFile(""));};H.NamedTemplate=function(cb,cc,cd){var ce,cf;ce=(cf=null,[H.LoadedTemplateFile(cb).TryGetValue(cc==null?"":cc.$0,{get:function(){return cf;},set:function(cg){cf=cg;}}),cf]);return ce[0]?H.ChildrenTemplate(ce[1].cloneNode(true),cd):(b8.warn("Local template doesn't exist",cc),I.get_Empty());};H.LocalTemplatesLoaded=function(){ba.$cctor();return ba.LocalTemplatesLoaded;};H.set_LocalTemplatesLoaded=function(cb){ba.$cctor();ba.LocalTemplatesLoaded=cb;};H.LoadNestedTemplates=function(cb,cc){var ce,cf,cg,ch,ci,cj,ck,cl,cm,cn,co,cp,cq,cr,cs,ct,cu,cv,cw,cx,cy;function cd(cz){var cA,cB;if(!ce.ContainsKey(cz)){cA=(cB=null,[cf.TryGetValue(cz,{get:function(){return cB;},set:function(cC){cB=cC;}}),cB]);if(cA[0]){cy.SAdd(cz);cf.RemoveKey(cz);H.PrepareTemplateStrict(cc,{$:1,$0:cz},cA[1],{$:1,$0:cd});}else b8.warn(cy.Contains(cz)?"Encountered loop when instantiating "+cz:"Local template does not exist: "+cz);}}ce=H.LoadedTemplateFile(cc);cf=new K.New$5();cg=cb.querySelectorAll("[ws-template]");for(ch=0,ci=cg.length-1;ch<=ci;ch++){cj=cg[ch];ck=cj.getAttribute("ws-template").toLowerCase();cj.removeAttribute("ws-template");cf.set_Item(ck,H.FakeRootSingle(cj));}cl=cb.querySelectorAll("[ws-children-template]");for(cm=0,cn=cl.length-1;cm<=cn;cm++){co=cl[cm];cp=co.getAttribute("ws-children-template").toLowerCase();co.removeAttribute("ws-children-template");cf.set_Item(cp,H.FakeRoot(co));}cq=cb.querySelectorAll("template[id]");for(cr=0,cs=cq.length-1;cr<=cs;cr++){ct=cq[cr];cf.set_Item(ct.getAttribute("id").toLowerCase(),H.FakeRootFromHTMLTemplate(ct));}cu=cb.querySelectorAll("template[name]");for(cv=0,cw=cu.length-1;cv<=cw;cv++){cx=cu[cv];cf.set_Item(cx.getAttribute("name").toLowerCase(),H.FakeRootFromHTMLTemplate(cx));}cy=new S.New$3();while(cf.count>0)cd(T.head(cf.Keys()));};H.LoadedTemplates=function(){ba.$cctor();return ba.LoadedTemplates;};H.LoadedTemplateFile=function(cb){var cc,cd,ce;cc=(cd=null,[H.LoadedTemplates().TryGetValue(cb,{get:function(){return cd;},set:function(cf){cd=cf;}}),cd]);return cc[0]?cc[1]:(ce=new K.New$5(),(H.LoadedTemplates().set_Item(cb,ce),ce));};H.ChildrenTemplate=function(cb,cc){var cd,ce,cf,cg,ch;cd=H.InlineTemplate(cb,T.append(cc,H.GlobalHoles().Values()));ce=cd[1];cf=cd[0];cg=cf.Els;return!r.Equals(cg,null)&&cg.length===1&&(m.get(cg,0)instanceof L&&(r.Equals(m.get(cg,0).nodeType,L.ELEMENT_NODE)&&(ch=m.get(cg,0),true)))?bj.TreeNode(cf,ce):I.Mk({$:6,$0:cf},ce);};H.FakeRootSingle=function(cb){var cc,cd,ce,cf;cb.removeAttribute("ws-template");cc=cb.getAttribute("ws-replace");if(cc==null);else{cb.removeAttribute("ws-replace");cd=cb.parentNode;r.Equals(cd,null)?void 0:(ce=self.document.createElement(cb.tagName),ce.setAttribute("ws-replace",cc),cd.replaceChild(ce,cb));}cf=self.document.createElement("div");cf.appendChild(cb);return cf;};H.FakeRoot=function(cb){var cc;cc=self.document.createElement("div");while(cb.hasChildNodes())cc.appendChild(cb.firstChild);return cc;};H.FakeRootFromHTMLTemplate=function(cb){var cc,cd,ce,cf;cc=self.document.createElement("div");cd=cb.content;for(ce=0,cf=cd.childNodes.length-1;ce<=cf;ce++)cc.appendChild(cd.childNodes[ce].cloneNode(true));return cc;};H.PrepareTemplateStrict=function(cb,cc,cd,ce){var cf,cg;function ch(cn,co){var cp,cq,cr,cs,ct,cv,cw,cx,cy,cz,cA,cB,cC,cD,cE,cF,cG,cH,cI,cJ,cK,cL,cM,cN,cO,cP;function cu(cQ){}while(true)switch(cn){case 0:if(co!==null){cp=co.nextSibling;if(r.Equals(co.nodeType,L.TEXT_NODE))bl.convertTextNode(co);else if(r.Equals(co.nodeType,L.ELEMENT_NODE))cj(co);co=cp;}else return null;break;case 1:cv=bm.string(co.nodeName,{$:1,$0:3},null).toLowerCase();cw=(cq=cv.indexOf("."),cq===-1?[cb,cv]:[bm.string(cv,null,{$:1,$0:cq-1}),bm.string(cv,{$:1,$0:cq+1},null)]);cx=cw[1];cy=cw[0];if(cy!=""&&!H.LoadedTemplates().ContainsKey(cy))return bl.failNotLoaded(cx);else{if(cy==""&&ce!=null)ce.$0(cx);cz=H.LoadedTemplates().Item(cy);if(!cz.ContainsKey(cx))return bl.failNotLoaded(cx);else{cA=cz.Item(cx);cB=cA.cloneNode(true);cC=new S.New$3();cD=new K.New$5();cE=co.attributes;for(cF=0,cG=cE.length-1;cF<=cG;cF++){cH=cE.item(cF).name.toLowerCase();cD.set_Item(cH,(cI=cE.item(cF).nodeValue,cI==""?cH:cI.toLowerCase()));if(!cC.SAdd(cH))b8.warn("Hole mapped twice",cH);}for(cJ=0,cK=co.childNodes.length-1;cJ<=cK;cJ++){cL=co.childNodes[cJ];if(r.Equals(cL.nodeType,L.ELEMENT_NODE))!cC.SAdd(cL.nodeName.toLowerCase())?b8.warn("Hole filled twice",cx):void 0;}cM=co.childNodes.length===1&&r.Equals(co.firstChild.nodeType,L.TEXT_NODE);if(cM){cs=bl.fillTextHole(cB,co.firstChild.textContent,cx);((function(cQ){return function(cR){if(cR!=null)cQ(cR.$0);};}((ct=function(cQ){return function(cR){return cQ.SAdd(cR);};}(cC),function(cQ){return cu(ct(cQ));})))(cs));}bl.removeHolesExcept(cB,cC);if(!cM){for(cN=0,cO=co.childNodes.length-1;cN<=cO;cN++){cP=co.childNodes[cN];if(r.Equals(cP.nodeType,L.ELEMENT_NODE))cP.hasAttributes()?bl.fillInstanceAttrs(cB,cP):ci(cB,cP);}}bl.mapHoles(cB,cD);bl.fill(cB,co.parentNode,co);co.parentNode.removeChild(co);return;}}break;}}function ci(cn,co){var cp,cq,cs,ct;function cr(cu,cv){var cw;if(cs=="title"&&co.hasChildNodes()){cw=bn.ParseHTMLIntoFakeRoot(co.textContent);co.removeChild(co.firstChild);while(cw.hasChildNodes())co.appendChild(cw.firstChild);}else null;cj(co);return bl.fill(co,cu,cv);}cs=co.nodeName.toLowerCase();H.foreachNotPreserved(cn,"[ws-attr-holes]",function(cu){var cv,cw,cx,cy,cz;cv=bE.SplitChars(cu.getAttribute("ws-attr-holes"),[" "],1);for(cw=0,cx=cv.length-1;cw<=cx;cw++){cy=m.get(cv,cw);cu.setAttribute(cy,(cz=new a.RegExp("\\${"+cs+"}","ig"),cu.getAttribute(cy).replace(cz,co.textContent)));}});ct=cn.querySelector("[ws-hole="+cs+"]");if(r.Equals(ct,null)){cp=cn.querySelector("[ws-replace="+cs+"]");return r.Equals(cp,null)?(cq=cn.querySelector("slot[name="+cs+"]"),cn.tagName.toLowerCase()=="template"?(cr(cq.parentNode,cq),void cq.parentNode.removeChild(cq)):null):(cr(cp.parentNode,cp),void cp.parentNode.removeChild(cp));}else{while(ct.hasChildNodes())ct.removeChild(ct.lastChild);ct.removeAttribute("ws-hole");return cr(ct,null);}}function cj(cn){if(!cn.hasAttribute("ws-preserve"))if(bE.StartsWith(cn.nodeName.toLowerCase(),"ws-"))cl(cn);else{bl.convertAttrs(cn);ck(cn.firstChild);}}function ck(cn){return ch(0,cn);}function cl(cn){return ch(1,cn);}function cm(cn){var co,cp,cq,cr,cs,ct,cu,cv,cw,cx,cy,cz;while(true){co=cn.querySelector("[ws-template]");if(r.Equals(co,null)){cp=cn.querySelector("[ws-children-template]");if(r.Equals(cp,null)){cq=cn.querySelectorAll("template[id]");for(cr=1,cs=cq.length-1;cr<=cs;cr++){ct=cq[cr];if(cf.Contains(ct));else{H.PrepareTemplateStrict(cb,{$:1,$0:ct.getAttribute("id")},ct,null);cf.SAdd(ct);}}cu=cn.querySelectorAll("template[name]");for(cv=1,cw=cu.length-1;cv<=cw;cv++){cx=cu[cv];if(cf.Contains(cx));else{H.PrepareTemplateStrict(cb,{$:1,$0:cx.getAttribute("name")},cx,null);cf.SAdd(cx);}}return null;}else{cy=cp.getAttribute("ws-children-template");cp.removeAttribute("ws-children-template");H.PrepareTemplateStrict(cb,{$:1,$0:cy},cp,null);cn=cn;}}else{cz=co.getAttribute("ws-template");(H.PrepareSingleTemplate(cb,{$:1,$0:cz},co))(null);cn=cn;}}}cf=new S.New$3();cg=(cc==null?"":cc.$0).toLowerCase();H.LoadedTemplateFile(cb).set_Item(cg,cd);if(cd.hasChildNodes()){cm(cd);ck(cd.firstChild);}};H.InlineTemplate=function(cb,cc){var cd,ce,cf,cg,ch,cl,cm,cn,co,cp,cq,cr;function ci(cs,ct){var cu,cv,cw;cu=bu.Insert(cs,ct);cm.push(bu.Updates(cu));cn.push([cs,cu]);cv=b_.GetOptional(cu.OnAfterRender);return cv==null?null:(cw=cv.$0,void co.push(function(){cw(cs);}));}function cj(cs){var ct,cu,cv,cw;ct=(cu=null,[cp.TryGetValue(cs,{get:function(){return cu;},set:function(cx){cu=cx;}}),cu]);return ct[0]?(cv=ct[1],cv instanceof bv?{$:1,$0:cv.get_Value()}:cv instanceof u?{$:1,$0:I.TextNode(cv.get_Value())}:(cw=cv.ForTextView(),cw==null?null:{$:1,$0:I.TextView(cw.$0)})):null;}function ck(){H.foreachNotPreservedwsDOM("[ws-dom]",function(cs){var ct,cu,cv,cw,cx,cy,cz;ct=(cu=null,[cp.TryGetValue(cs.getAttribute("ws-dom").toLowerCase(),{get:function(){return cu;},set:function(cA){cu=cA;}}),cu]);if(ct[0]){cv=ct[1];cv instanceof _0?(cw=cv.get_Value(),cs.removeAttribute("ws-dom"),cx=cs,cy=new a.MutationObserver(function(cA,cB){m.iter(function(cC){function cD(cE,cF,cG,cH){if(cE===cx&&cC.addedNodes.length!==1){cw.SetFinal(null);cB.disconnect();}}cC.removedNodes.forEach(b_.CreateFuncWithArgs(function(cE){return cD(cE[0],cE[1],cE[2],cE[3]);}),null);},cA);}),cs.parentElement!==null?cy.observe(cs.parentElement,(cz={},cz.childList=true,cz)):void 0,cw.Set({$:1,$0:cs}),_1.Sink(function(cA){var cB;if(cA!=null&&cA.$==1){cB=cA.$0;if(cx===cB);else{cx.replaceWith.apply(cx,[cB]);cx=cB;}}else{cx.remove();cy.disconnect();}},cw.get_View())):void 0;}});}cl=[];cm=[];cn=[];co=[];cp=new K.New$5();cq=_.Get(cc);try{while(cq.MoveNext()){cr=cq.Current();cp.set_Item(cr.get_Name(),cr);}}finally{if(typeof cq=="object"&&"Dispose"in cq)cq.Dispose();}cd=bn.ChildrenArray(cb);H.foreachNotPreserved(cb,"[ws-hole]",function(cs){var ct,cu,cv;cv=cs.getAttribute("ws-hole");cs.removeAttribute("ws-hole");while(cs.hasChildNodes())cs.removeChild(cs.lastChild);ct=cj(cv);if(ct!=null&&ct.$==1){cu=ct.$0;bb.LinkElement(cs,cu.docNode);cl.push(bc.New(bu.Empty(cs),cu.docNode,null,cs,bf.Int(),null));cm.push(cu.updates);}});H.foreachNotPreserved(cb,"[ws-replace]",function(cs){var ct,cu,cv,cw,cx,cy;ct=cj(cs.getAttribute("ws-replace"));if(ct!=null&&ct.$==1){cu=ct.$0;cv=cs.parentNode;cw=self.document.createTextNode("");cv.replaceChild(cw,cs);cx=bb.InsertBeforeDelim(cw,cu.docNode);cy=m.tryFindIndex(function(cz){return cs===cz;},cd);cy==null?void 0:m.set(cd,cy.$0,cu.docNode);cl.push(bc.New(bu.Empty(cv),cu.docNode,{$:1,$0:[cx,cw]},cv,bf.Int(),null));cm.push(cu.updates);}});ce=false;H.foreachNotPreserved(cb,"slot",function(cs){var ct,cu,cv,cw;cv=cs.getAttribute("name");cw=cv==""||cv==null?"default":cv.toLowerCase();if(ce&&cw=="default"||!r.Equals(cb.parentElement,null))void 0;else{while(cs.hasChildNodes())cs.removeChild(cs.lastChild);if(cw=="default")ce=true;ct=cj(cw);if(ct!=null&&ct.$==1){cu=ct.$0;bb.LinkElement(cs,cu.docNode);cl.push(bc.New(bu.Empty(cs),cu.docNode,null,cs,bf.Int(),null));cm.push(cu.updates);}}});H.foreachNotPreserved(cb,"[ws-attr]",function(cs){var ct,cu,cv,cw;ct=cs.getAttribute("ws-attr");cs.removeAttribute("ws-attr");cu=(cv=null,[cp.TryGetValue(ct,{get:function(){return cv;},set:function(cx){cv=cx;}}),cv]);if(cu[0]){cw=cu[1];cw instanceof bw?ci(cs,cw.get_Value()):b8.warn("Attribute hole filled with non-attribute data",ct);}});H.foreachNotPreserved(cb,"[ws-on]",function(cs){ci(cs,bz.Concat(m.choose(function(ct){var cu,cv,cw,cx;cu=bE.SplitChars(ct,[":"],1);cv=(cw=null,[cp.TryGetValue(m.get(cu,1),{get:function(){return cw;},set:function(cy){cw=cy;}}),cw]);return cv[0]?(cx=cv[1],cx instanceof bx?{$:1,$0:by.Handler(m.get(cu,0),cx.get_Value())}:cx instanceof z?{$:1,$0:bz.Handler(m.get(cu,0),cx.get_Value())}:(b8.warn("Event hole on"+m.get(cu,0)+" filled with non-event data",m.get(cu,1)),null)):null;},bE.SplitChars(cs.getAttribute("ws-on"),[" "],1))));cs.removeAttribute("ws-on");});H.foreachNotPreserved(cb,"[ws-onafterrender]",function(cs){var ct,cu,cv,cw;ct=cs.getAttribute("ws-onafterrender");cu=(cv=null,[cp.TryGetValue(ct,{get:function(){return cv;},set:function(cx){cv=cx;}}),cv]);if(cu[0]){cw=cu[1];cw instanceof bA?(cs.removeAttribute("ws-onafterrender"),ci(cs,by.OnAfterRender(cw.get_Value()))):cw instanceof bB?(cs.removeAttribute("ws-onafterrender"),ci(cs,by.OnAfterRender(cw.get_Value()))):b8.warn("onafterrender hole filled with non-onafterrender data",ct);}});H.foreachNotPreserved(cb,"[ws-var]",function(cs){var ct,cu,cv;ct=cs.getAttribute("ws-var");cs.removeAttribute("ws-var");cu=(cv=null,[cp.TryGetValue(ct,{get:function(){return cv;},set:function(cw){cv=cw;}}),cv]);if(cu[0])cu[1].AddAttribute(function(cw){return function(cx){return ci(cw,cx);};},cs);});H.foreachNotPreserved(cb,"[ws-attr-holes]",function(cs){var ct,cu,cv,cw;ct=new a.RegExp(H.TextHoleRE(),"g");cu=bE.SplitChars(cs.getAttribute("ws-attr-holes"),[" "],1);cs.removeAttribute("ws-attr-holes");for(cv=0,cw=cu.length-1;cv<=cw;cv++)(function(){var cx,cy,cz,cA,cB,cC,cD,cE,cF,cG,cH,cI,cJ;cG=m.get(cu,cv);cH=cs.getAttribute(cG);cx=null;cy=0;cI=[];while(cx=ct.exec(cH),cx!==null){cJ=bm.string(cH,{$:1,$0:cy},{$:1,$0:ct.lastIndex-m.get(cx,0).length-1});cy=ct.lastIndex;cI.push([cJ,m.get(cx,1)]);}cA=bm.string(cH,{$:1,$0:cy},null);ct.lastIndex=0;cB=m.foldBack(function(cK,cL){return(function(cM){var cN,cO;cN=cM[0];cO=cM[1];return function(cP){var cQ,cR,cS,cT,cU;cQ=cP[0];cR=cP[1];cS=(cT=(cU=null,[cp.TryGetValue(cO,{get:function(){return cU;},set:function(cV){cU=cV;}}),cU]),cT[0]?cT[1].get_AsChoiceView():{$:0,$0:""});return cS.$==1?[cN,new bD({$:1,$0:cQ==""?cS.$0:_1.Map(function(cV){return cV+cQ;},cS.$0),$1:cR})]:[cN+cS.$0+cQ,cR];};}(cK))(cL);},cI,[cA,bD.Empty]);return ci(cs,cB[1].$==1?cB[1].$1.$==1?cB[1].$1.$1.$==1?cB[1].$1.$1.$1.$==0?(cC=cB[0],by.Dynamic(cG,_1.Map3(function(cK,cL,cM){return cC+cK+cL+cM;},cB[1].$0,cB[1].$1.$0,cB[1].$1.$1.$0))):(cD=cB[0],by.Dynamic(cG,_1.Map(function(cK){return cD+bE.concat("",cK);},_1.Sequence(cB[1])))):(cE=cB[0],by.Dynamic(cG,_1.Map2(function(cK,cL){return cE+cK+cL;},cB[1].$0,cB[1].$1.$0))):cB[0]==""?by.Dynamic(cG,cB[1].$0):(cF=cB[0],by.Dynamic(cG,_1.Map(function(cK){return cF+cK;},cB[1].$0))):bz.Create(cG,cB[0]));}());});return[b_.DeleteEmptyFields({Els:cd,Dirty:true,Holes:cl,Attrs:cn,Render:(cf=co.length==0?{$:1,$0:function(){ck();}}:{$:1,$0:function(cs){ck();m.iter(function(ct){ct(cs);},co);}},cf?cf.$0:void 0),El:(cg=!r.Equals(cd,null)&&cd.length===1&&(m.get(cd,0)instanceof L&&(m.get(cd,0)instanceof bk&&(ch=m.get(cd,0),true)))?{$:1,$0:ch}:null,cg?cg.$0:void 0)},["Render","El"]),bF.TreeReduce(_1.Const(),_1.Map2Unit,cm)];};H.GlobalHoles=function(){ba.$cctor();return ba.GlobalHoles;};H.foreachNotPreserved=function(cb,cc,cd){bn.IterSelector(cb,cc,function(ce){if(ce.closest("[ws-preserve]")==null)cd(ce);});};H.PrepareSingleTemplate=function(cb,cc,cd){var ce;ce=H.FakeRootSingle(cd);return function(cf){H.PrepareTemplateStrict(cb,cc,ce,cf);};};H.foreachNotPreservedwsDOM=function(cb,cc){bn.IterSelectorDoc(cb,function(cd){if(cd.closest("[ws-preserve]")==null)cc(cd);});};H.TextHoleRE=function(){ba.$cctor();return ba.TextHoleRE;};I=h.Doc=b_.Class({},g,I);I.RunById=function(cb,cc){var cd;cd=self.document.getElementById(cb);if(r.Equals(cd,null))f.FailWith("invalid id: "+cb);else I.Run(cd,cc);};I.Run=function(cb,cc){bb.LinkElement(cb,cc.docNode);I.RunInPlace(false,cb,cc);};I.get_Empty=function(){return I.Mk(null,_1.Const());};I.RunInPlace=function(cb,cc,cd){var ce;ce=bb.CreateRunState(cc,cd.docNode);_1.Sink(bp.get_UseAnimations()||bq.BatchUpdatesEnabled()?br.StartProcessor(bb.PerformAnimatedUpdate(cb,ce,cd.docNode)):function(){bb.PerformSyncUpdate(cb,ce,cd.docNode);},cd.updates);};I.Mk=function(cb,cc){return new I.New(cb,cc);};I.TextNode=function(cb){return I.Mk({$:5,$0:self.document.createTextNode(cb)},_1.Const());};I.TextView=function(cb){var cc;cc=bb.CreateTextNode();return I.Mk({$:4,$0:cc},_1.Map(function(cd){bb.UpdateTextNode(cc,cd);},cb));};I.New=b_.Ctor(function(cb,cc){g.New.call(this);this.docNode=cb;this.updates=cc;},I);K=J.Dictionary=b_.Class({set_Item:function(cb,cc){this.set(cb,cc);},set:function(cb,cc){var cd,ce,cf,cg;cd=this;ce=this.hash(cb);cf=this.data[ce];if(cf==null){this.count=this.count+1;this.data[ce]=new a.Array({K:cb,V:cc});}else{cg=m.tryFindIndex(function(ch){return cd.equals.apply(null,[(f.KeyValue(ch))[0],cb]);},cf);cg==null?(this.count=this.count+1,cf.push({K:cb,V:cc})):cf[cg.$0]={K:cb,V:cc};}},TryGetValue:function(cb,cc){var cd,ce,cf;cd=this;ce=this.data[this.hash(cb)];return ce==null?false:(cf=m.tryPick(function(cg){var ch;ch=f.KeyValue(cg);return cd.equals.apply(null,[ch[0],cb])?{$:1,$0:ch[1]}:null;},ce),cf!=null&&cf.$==1&&(cc.set(cf.$0),true));},ContainsKey:function(cb){var cc,cd;cc=this;cd=this.data[this.hash(cb)];return cd==null?false:m.exists(function(ce){return cc.equals.apply(null,[(f.KeyValue(ce))[0],cb]);},cd);},RemoveKey:function(cb){return this.remove(cb);},Keys:function(){return new bo.New(this);},GetEnumerator:function(){return _.Get0(m.concat(P.GetFieldValues(this.data)));},Values:function(){return new bH.New(this);},remove:function(cb){var cc,cd,ce,cf;cc=this;cd=this.hash(cb);ce=this.data[cd];return ce==null?false:(cf=m.filter(function(cg){return!cc.equals.apply(null,[(f.KeyValue(cg))[0],cb]);},ce),m.length(cf)<ce.length&&(this.count=this.count-1,this.data[cd]=cf,true));},Item:function(cb){return this.get(cb);},get:function(cb){var cc,cd;cc=this;cd=this.data[this.hash(cb)];return cd==null?_9.notPresent():m.pick(function(ce){var cf;cf=f.KeyValue(ce);return cc.equals.apply(null,[cf[0],cb])?{$:1,$0:cf[1]}:null;},cd);}},g,K);K.New$5=b_.Ctor(function(){K.New$6.call(this,[],r.Equals,r.Hash);},K);K.New$6=b_.Ctor(function(cb,cc,cd){var ce,cf;g.New.call(this);this.equals=cc;this.hash=cd;this.count=0;this.data=[];ce=_.Get(cb);try{while(ce.MoveNext()){cf=ce.Current();this.set(cf.K,cf.V);}}finally{if(typeof ce=="object"&&"Dispose"in ce)ce.Dispose();}},K);N=h.Var$1=b_.Class({},g,N);N.Create$1=function(cb){return new _3.New(false,_4.New({$:2,$0:cb,$1:[]}),cb);};P.GetFieldValues=function(cb){var cc,cd;cc=[];for(var ce in cb)cc.push(cb[ce]);return cc;};Q.New=function(cb,cc){return{k:cb,ct:cc};};R.New=function(cb,cc){return{c:cb,r:cc};};S=J.HashSet=b_.Class({SAdd:function(cb){return this.add(cb);},Contains:function(cb){var cc;cc=this.data[this.hash(cb)];return cc==null?false:this.arrContains(cb,cc);},add:function(cb){var cc,cd;cc=this.hash(cb);cd=this.data[cc];return cd==null?(this.data[cc]=[cb],this.count=this.count+1,true):this.arrContains(cb,cd)?false:(cd.push(cb),this.count=this.count+1,true);},arrContains:function(cb,cc){var cd,ce,cf,cg;cd=true;ce=0;cg=cc.length;while(cd&&ce<cg)if(this.equals.apply(null,[cc[ce],cb]))cd=false;else ce=ce+1;return!cd;},GetEnumerator:function(){return _.Get(bN.concat(this.data));},ExceptWith:function(cb){var cc;cc=_.Get(cb);try{while(cc.MoveNext())this.Remove(cc.Current());}finally{if(typeof cc=="object"&&"Dispose"in cc)cc.Dispose();}},Count:function(){return this.count;},IntersectWith:function(cb){var cc,cd,ce,cf,cg;cc=new S.New$4(cb,this.equals,this.hash);cd=bN.concat(this.data);for(ce=0,cf=cd.length-1;ce<=cf;ce++){cg=cd[ce];if(!cc.Contains(cg))this.Remove(cg);}},Remove:function(cb){var cc;cc=this.data[this.hash(cb)];return cc==null?false:this.arrRemove(cb,cc)&&(this.count=this.count-1,true);},CopyTo:function(cb,cc){var cd,ce,cf;cd=bN.concat(this.data);for(ce=0,cf=cd.length-1;ce<=cf;ce++)m.set(cb,ce+cc,cd[ce]);},arrRemove:function(cb,cc){var cd,ce,cf,cg;cd=true;ce=0;cg=cc.length;while(cd&&ce<cg)if(this.equals.apply(null,[cc[ce],cb])){cc.splice.apply(cc,[ce,1]);cd=false;}else ce=ce+1;return!cd;}},g,S);S.New$3=b_.Ctor(function(){S.New$4.call(this,[],r.Equals,r.Hash);},S);S.New$4=b_.Ctor(function(cb,cc,cd){var ce;g.New.call(this);this.equals=cc;this.hash=cd;this.data=[];this.count=0;ce=_.Get(cb);try{while(ce.MoveNext())this.add(ce.Current());}finally{if(typeof ce=="object"&&"Dispose"in ce)ce.Dispose();}},S);S.New$2=b_.Ctor(function(cb){S.New$4.call(this,cb,r.Equals,r.Hash);},S);T.append=function(cb,cc){return{GetEnumerator:function(){var cd,ce;cd=_.Get(cb);ce=[true];return new $.New(cd,null,function(cf){var cg;return cf.s.MoveNext()?(cf.c=cf.s.Current(),true):(cg=cf.s,!r.Equals(cg,null)?cg.Dispose():void 0,cf.s=null,ce[0]&&(ce[0]=false,cf.s=_.Get(cc),cf.s.MoveNext()?(cf.c=cf.s.Current(),true):(cf.s.Dispose(),cf.s=null,false)));},function(cf){var cg;cg=cf.s;if(!r.Equals(cg,null))cg.Dispose();});}};};T.head=function(cb){var cc;cc=_.Get(cb);try{return cc.MoveNext()?cc.Current():T.insufficient();}finally{if(typeof cc=="object"&&"Dispose"in cc)cc.Dispose();}};T.fold=function(cb,cc,cd){var ce,cf;ce=cc;cf=_.Get(cd);try{while(cf.MoveNext())ce=cb(ce,cf.Current());return ce;}finally{if(typeof cf=="object"&&"Dispose"in cf)cf.Dispose();}};T.iter=function(cb,cc){var cd;cd=_.Get(cc);try{while(cd.MoveNext())cb(cd.Current());}finally{if(typeof cd=="object"&&"Dispose"in cd)cd.Dispose();}};T.map=function(cb,cc){return{GetEnumerator:function(){var cd;cd=_.Get(cc);return new $.New(null,null,function(ce){return cd.MoveNext()&&(ce.c=cb(cd.Current()),true);},function(){cd.Dispose();});}};};T.delay=function(cb){return{GetEnumerator:function(){return _.Get(cb());}};};T.max=function(cb){var cc,cd,ce;cc=_.Get(cb);try{if(!cc.MoveNext())T.seqEmpty();cd=cc.Current();while(cc.MoveNext()){ce=cc.Current();if(r.Compare(ce,cd)===1)cd=ce;}return cd;}finally{if(typeof cc=="object"&&"Dispose"in cc)cc.Dispose();}};T.init=function(cb,cc){return T.take(cb,T.initInfinite(cc));};T.seqEmpty=function(){return f.FailWith("The input sequence was empty.");};T.forall=function(cb,cc){return!T.exists(function(cd){return!cb(cd);},cc);};T.take=function(cb,cc){cb<0?T.nonNegative():void 0;return{GetEnumerator:function(){var cd;cd=[_.Get(cc)];return new $.New(0,null,function(ce){var cf;ce.s=ce.s+1;return ce.s>cb?false:(cf=cd[0],r.Equals(cf,null)?T.insufficient():cf.MoveNext()?(ce.c=cf.Current(),ce.s===cb?(cf.Dispose(),cd[0]=null):void 0,true):(cf.Dispose(),cd[0]=null,T.insufficient()));},function(){var ce;ce=cd[0];if(!r.Equals(ce,null))ce.Dispose();});}};};T.initInfinite=function(cb){return{GetEnumerator:function(){return new $.New(0,null,function(cc){cc.c=cb(cc.s);cc.s=cc.s+1;return true;},void 0);}};};T.exists=function(cb,cc){var cd,ce;cd=_.Get(cc);try{ce=false;while(!ce&&cd.MoveNext())ce=cb(cd.Current());return ce;}finally{if(typeof cd=="object"&&"Dispose"in cd)cd.Dispose();}};m.choose=function(cb,cc){var cd,ce,cf,cg;cd=[];for(ce=0,cf=cc.length-1;ce<=cf;ce++){cg=cb(cc[ce]);if(cg==null);else cd.push(cg.$0);}return cd;};m.tryFindIndex=function(cb,cc){var cd,ce;cd=null;ce=0;while(ce<cc.length&&cd==null){cb(cc[ce])?cd={$:1,$0:ce}:void 0;ce=ce+1;}return cd;};m.tryPick=function(cb,cc){var cd,ce,cf;cd=null;ce=0;while(ce<cc.length&&cd==null){cf=cb(cc[ce]);if(cf!=null&&cf.$==1)cd=cf;ce=ce+1;}return cd;};m.exists=function(cb,cc){var cd,ce,cf,cg;cd=false;ce=0;cg=m.length(cc);while(!cd&&ce<cg)if(cb(cc[ce]))cd=true;else ce=ce+1;return cd;};m.concat=function(cb){return a.Array.prototype.concat.apply([],m.ofSeq(cb));};m.iter=function(cb,cc){var cd,ce;for(cd=0,ce=cc.length-1;cd<=ce;cd++)cb(cc[cd]);};m.foldBack=function(cb,cc,cd){var ce,cf,cg,ch,ci;ce=cd;cg=cc.length;for(ch=1,ci=cg;ch<=ci;ch++)ce=cb(cc[cg-ch],ce);return ce;};m.map=function(cb,cc){var cd,ce,cf;cd=new a.Array(cc.length);for(ce=0,cf=cc.length-1;ce<=cf;ce++)cd[ce]=cb(cc[ce]);return cd;};m.filter=function(cb,cc){var cd,ce,cf;cd=[];for(ce=0,cf=cc.length-1;ce<=cf;ce++)if(cb(cc[ce]))cd.push(cc[ce]);return cd;};m.ofSeq=function(cb){var cc,cd;if(cb instanceof a.Array)return cb.slice();else if(cb instanceof bD)return m.ofList(cb);else{cc=[];cd=_.Get(cb);try{while(cd.MoveNext())cc.push(cd.Current());return cc;}finally{if(typeof cd=="object"&&"Dispose"in cd)cd.Dispose();}}};m.pick=function(cb,cc){var cd;cd=m.tryPick(cb,cc);return cd==null?f.FailWith("KeyNotFoundException"):cd.$0;};m.ofList=function(cb){var cc,cd;cd=[];cc=cb;while(!(cc.$==0)){cd.push(bC.head(cc));cc=bC.tail(cc);}return cd;};m.forall=function(cb,cc){var cd,ce,cf,cg;cd=true;ce=0;cg=m.length(cc);while(cd&&ce<cg)if(cb(cc[ce]))ce=ce+1;else cd=false;return cd;};m.create=function(cb,cc){var cd,ce,cf;cd=new a.Array(cb);for(ce=0,cf=cb-1;ce<=cf;ce++)cd[ce]=cc;return cd;};m.init=function(cb,cc){var cd,ce,cf;if(cb<0)f.FailWith("Negative size given.");else null;cd=new a.Array(cb);for(ce=0,cf=cb-1;ce<=cf;ce++)cd[ce]=cc(ce);return cd;};U.$cctor=function(){U.$cctor=a.ignore;U.initialized=new K.New$5();};U=k.TemplateInitializer=b_.Class({},g,U);U.GetOrAddHoleFor=function(cb,cc,cd){var ce,cf,cg,ch;U.$cctor();ce=U.GetHolesFor(cb);cf=(cg=null,[ce.TryGetValue(cc,{get:function(){return cg;},set:function(ci){cg=ci;}}),cg]);return cf[0]?cf[1]:(ch=cd(),(ce.set_Item(cc,ch),ch));};U.GetHolesFor=function(cb){var cc,cd,ce;U.$cctor();cc=(cd=null,[U.initialized.TryGetValue(cb,{get:function(){return cd;},set:function(cf){cd=cf;}}),cd]);return cc[0]?cc[1]:(ce=new K.New$5(),(U.initialized.set_Item(cb,ce),ce));};V=t.VarStr=b_.Class({get_Name:function(){return this.name;},ForTextView:function(){return{$:1,$0:this.fillWith.get_View()};},AddAttribute:function(cb,cc){(cb(cc))(by.Value(this.fillWith));},get_AsChoiceView:function(){return{$:1,$0:_1.Map(a.String,this.fillWith.get_View())};}},o,V);V.New=b_.Ctor(function(cb,cc){o.New.call(this);this.name=cb;this.fillWith=cc;},V);W=t.VarFloatUnchecked=b_.Class({get_Name:function(){return this.name;},ForTextView:function(){return{$:1,$0:_1.Map(a.String,this.fillWith.get_View())};},AddAttribute:function(cb,cc){(cb(cc))(by.FloatValueUnchecked(this.fillWith));},get_AsChoiceView:function(){return{$:1,$0:_1.Map(a.String,this.fillWith.get_View())};}},o,W);W.New=b_.Ctor(function(cb,cc){o.New.call(this);this.name=cb;this.fillWith=cc;},W);X=t.VarBool=b_.Class({get_Name:function(){return this.name;},ForTextView:function(){return{$:1,$0:_1.Map(a.String,this.fillWith.get_View())};},AddAttribute:function(cb,cc){(cb(cc))(by.Checked(this.fillWith));},get_AsChoiceView:function(){return{$:1,$0:_1.Map(a.String,this.fillWith.get_View())};}},o,X);X.New=b_.Ctor(function(cb,cc){o.New.call(this);this.name=cb;this.fillWith=cc;},X);Y=t.VarDateTime=b_.Class({get_Name:function(){return this.name;},ForTextView:function(){return{$:1,$0:_1.Map(function(cb){return(new a.Date(cb)).toLocaleString();},this.fillWith.get_View())};},AddAttribute:function(cb,cc){(cb(cc))(by.DateTimeValue(this.fillWith));},get_AsChoiceView:function(){return{$:1,$0:_1.Map(function(cb){return(new a.Date(cb)).toLocaleString();},this.fillWith.get_View())};}},o,Y);Y.New=b_.Ctor(function(cb,cc){o.New.call(this);this.name=cb;this.fillWith=cc;},Y);Z=t.VarFile=b_.Class({get_Name:function(){return this.name;},ForTextView:function(){return{$:1,$0:_1.Map(a.String,this.fillWith.get_View())};},AddAttribute:function(cb,cc){(cb(cc))(by.FileValue(this.fillWith));},get_AsChoiceView:function(){return{$:1,$0:_1.Map(a.String,this.fillWith.get_View())};}},o,Z);Z.New=b_.Ctor(function(cb,cc){o.New.call(this);this.name=cb;this.fillWith=cc;},Z);_0=t.VarDomElement=b_.Class({get_Name:function(){return this.name;},get_Value:function(){return this.fillWith;}},o,_0);_0.New=b_.Ctor(function(cb,cc){o.New.call(this);this.name=cb;this.fillWith=cc;},_0);_1=h.View=b_.Class({},null,_1);_2.TryParseInt32=function(cb,cc){return _2.TryParse(cb,-2147483648,2147483647,cc);};_3=h.ConcreteVar=b_.Class({get_View:function(){return this.view;},Set:function(cb){if(this.isConst)(function(cc){return cc("WebSharper.UI: invalid attempt to change value of a Var after calling SetFinal");}(function(cc){b8.log(cc);}));else{_4.Obsolete(this.snap);this.current=cb;this.snap=_4.New({$:2,$0:cb,$1:[]});}},Get:function(){return this.current;},SetFinal:function(cb){if(this.isConst)(function(cc){return cc("WebSharper.UI: invalid attempt to change value of a Var after calling SetFinal");}(function(cc){b8.log(cc);}));else{_4.Obsolete(this.snap);this.isConst=true;this.current=cb;this.snap=_4.New({$:0,$0:cb});}},UpdateMaybe:function(cb){var cc;cc=cb(this.Get());if(cc!=null&&cc.$==1)this.Set(cc.$0);}},p,_3);_3.New=b_.Ctor(function(cb,cc,cd){var ce;ce=this;p.New.call(this);this.isConst=cb;this.current=cd;this.snap=cc;this.view=function(){return ce.snap;};this.id=bf.Int();},_3);_4.WhenRun=function(cb,cc,cd){var ce;ce=cb.s;if(ce==null)cd();else ce!=null&&ce.$==2?(ce.$1.push(cd),cc(ce.$0)):ce!=null&&ce.$==3?(ce.$0.push(cc),ce.$1.push(cd)):cc(ce.$0);};_4.Map=function(cb,cc){var cd,ce;cd=cc.s;return cd!=null&&cd.$==0?_4.New({$:0,$0:cb(cd.$0)}):(ce=_4.New({$:3,$0:[],$1:[]}),(_4.When(cc,function(cf){_4.MarkDone(ce,cc,cb(cf));},ce),ce));};_4.Map3=function(cb,cc,cd,ce){var cf,cg,ch,ci;function cj(ck){var cl,cm,cn,co;if(!(cl=ci.s,cl!=null&&cl.$==0||cl!=null&&cl.$==2)){cm=_4.ValueAndForever(cc);cn=_4.ValueAndForever(cd);co=_4.ValueAndForever(ce);if(cm!=null&&cm.$==1)cn!=null&&cn.$==1?co!=null&&co.$==1?cm.$0[1]&&cn.$0[1]&&co.$0[1]?_4.MarkForever(ci,cb(cm.$0[0],cn.$0[0],co.$0[0])):_4.MarkReady(ci,cb(cm.$0[0],cn.$0[0],co.$0[0])):void 0:void 0;}}cf=cc.s;cg=cd.s;ch=ce.s;return cf!=null&&cf.$==0?cg!=null&&cg.$==0?ch!=null&&ch.$==0?_4.New({$:0,$0:cb(cf.$0,cg.$0,ch.$0)}):_4.Map3Opt1(cb,cf.$0,cg.$0,ce):ch!=null&&ch.$==0?_4.Map3Opt2(cb,cf.$0,ch.$0,cd):_4.Map3Opt3(cb,cf.$0,cd,ce):cg!=null&&cg.$==0?ch!=null&&ch.$==0?_4.Map3Opt4(cb,cg.$0,ch.$0,cc):_4.Map3Opt5(cb,cg.$0,cc,ce):ch!=null&&ch.$==0?_4.Map3Opt6(cb,ch.$0,cc,cd):(ci=_4.New({$:3,$0:[],$1:[]}),(_4.When(cc,cj,ci),_4.When(cd,cj,ci),_4.When(ce,cj,ci),ci));};_4.Sequence=function(cb){var cc,cd,ce;function cf(cg){var ch;if(ce[0]===0){ch=m.map(function(ci){var cj;cj=ci.s;return cj!=null&&cj.$==0?cj.$0:cj!=null&&cj.$==2?cj.$0:f.FailWith("value not found by View.Sequence");},cc);if(m.forall(function(ci){var cj;cj=ci.s;return cj!=null&&cj.$==0;},cc))_4.MarkForever(cd,ch);else _4.MarkReady(cd,ch);}else ce[0]=ce[0]-1;}cc=m.ofSeq(cb);return cc.length==0?_4.New({$:0,$0:[]}):(cd=_4.New({$:3,$0:[],$1:[]}),(ce=[m.length(cc)-1],(m.iter(function(cg){_4.When(cg,cf,cd);},cc),cd)));};_4.Map2=function(cb,cc,cd){var ce,cf,cg;function ch(ci){var cj,ck,cl;if(!(cj=cg.s,cj!=null&&cj.$==0||cj!=null&&cj.$==2)){ck=_4.ValueAndForever(cc);cl=_4.ValueAndForever(cd);if(ck!=null&&ck.$==1)cl!=null&&cl.$==1?ck.$0[1]&&cl.$0[1]?_4.MarkForever(cg,cb(ck.$0[0],cl.$0[0])):_4.MarkReady(cg,cb(ck.$0[0],cl.$0[0])):void 0;}}ce=cc.s;cf=cd.s;return ce!=null&&ce.$==0?cf!=null&&cf.$==0?_4.New({$:0,$0:cb(ce.$0,cf.$0)}):_4.Map2Opt1(cb,ce.$0,cd):cf!=null&&cf.$==0?_4.Map2Opt2(cb,cf.$0,cc):(cg=_4.New({$:3,$0:[],$1:[]}),(_4.When(cc,ch,cg),_4.When(cd,ch,cg),cg));};_4.Map2Unit=function(cb,cc){var cd,ce,cf;function cg(){var ch,ci,cj;if(!(ch=cf.s,ch!=null&&ch.$==0||ch!=null&&ch.$==2)){ci=_4.ValueAndForever(cb);cj=_4.ValueAndForever(cc);if(ci!=null&&ci.$==1)cj!=null&&cj.$==1?ci.$0[1]&&cj.$0[1]?_4.MarkForever(cf,null):_4.MarkReady(cf,null):void 0;}}cd=cb.s;ce=cc.s;return cd!=null&&cd.$==0?ce!=null&&ce.$==0?_4.New({$:0,$0:null}):cc:ce!=null&&ce.$==0?cb:(cf=_4.New({$:3,$0:[],$1:[]}),(_4.When(cb,cg,cf),_4.When(cc,cg,cf),cf));};_4.Copy=function(cb){var cc,cd,ce;cc=cb.s;return cc==null?cb:cc!=null&&cc.$==2?(cd=_4.New({$:2,$0:cc.$0,$1:[]}),(_4.WhenObsolete(cb,cd),cd)):cc!=null&&cc.$==3?(ce=_4.New({$:3,$0:[],$1:[]}),(_4.When(cb,function(cf){_4.MarkDone(ce,cb,cf);},ce),ce)):cb;};_4.WhenObsoleteRun=function(cb,cc){var cd;cd=cb.s;if(cd==null)cc();else cd!=null&&cd.$==2?cd.$1.push(cc):cd!=null&&cd.$==3?cd.$1.push(cc):void 0;};_4.When=function(cb,cc,cd){var ce;ce=cb.s;if(ce==null)_4.Obsolete(cd);else ce!=null&&ce.$==2?(_4.EnqueueSafe(ce.$1,cd),cc(ce.$0)):ce!=null&&ce.$==3?(ce.$0.push(cc),_4.EnqueueSafe(ce.$1,cd)):cc(ce.$0);};_4.MarkDone=function(cb,cc,cd){var ce;if(ce=cc.s,ce!=null&&ce.$==0)_4.MarkForever(cb,cd);else _4.MarkReady(cb,cd);};_4.Map3Opt1=function(cb,cc,cd,ce){return _4.Map(function(cf){return cb(cc,cd,cf);},ce);};_4.Map3Opt2=function(cb,cc,cd,ce){return _4.Map(function(cf){return cb(cc,cf,cd);},ce);};_4.Map3Opt3=function(cb,cc,cd,ce){return _4.Map2(function(cf,cg){return cb(cc,cf,cg);},cd,ce);};_4.Map3Opt4=function(cb,cc,cd,ce){return _4.Map(function(cf){return cb(cf,cc,cd);},ce);};_4.Map3Opt5=function(cb,cc,cd,ce){return _4.Map2(function(cf,cg){return cb(cf,cc,cg);},cd,ce);};_4.Map3Opt6=function(cb,cc,cd,ce){return _4.Map2(function(cf,cg){return cb(cf,cg,cc);},cd,ce);};_4.ValueAndForever=function(cb){var cc;cc=cb.s;return cc!=null&&cc.$==0?{$:1,$0:[cc.$0,true]}:cc!=null&&cc.$==2?{$:1,$0:[cc.$0,false]}:null;};_4.MarkForever=function(cb,cc){var cd,ce,cf,cg;cd=cb.s;if(cd!=null&&cd.$==3){cb.s={$:0,$0:cc};ce=cd.$0;for(cf=0,cg=m.length(ce)-1;cf<=cg;cf++)(m.get(ce,cf))(cc);}else void 0;};_4.MarkReady=function(cb,cc){var cd,ce,cf,cg;cd=cb.s;if(cd!=null&&cd.$==3){cb.s={$:2,$0:cc,$1:cd.$1};ce=cd.$0;for(cf=0,cg=m.length(ce)-1;cf<=cg;cf++)(m.get(ce,cf))(cc);}else void 0;};_4.Map2Opt1=function(cb,cc,cd){return _4.Map(function(ce){return cb(cc,ce);},cd);};_4.Map2Opt2=function(cb,cc,cd){return _4.Map(function(ce){return cb(ce,cc);},cd);};_4.WhenObsolete=function(cb,cc){var cd;cd=cb.s;if(cd==null)_4.Obsolete(cc);else cd!=null&&cd.$==2?_4.EnqueueSafe(cd.$1,cc):cd!=null&&cd.$==3?_4.EnqueueSafe(cd.$1,cc):void 0;};_4.EnqueueSafe=function(cb,cc){var cd,ce,cf,cg;cb.push(cc);if(cb.length%20===0){cd=cb.slice(0);b5.Clear(cb);for(ce=0,cf=m.length(cd)-1;ce<=cf;ce++){cg=m.get(cd,ce);if(typeof cg=="object")(function(ch){if(ch.s)cb.push(ch);}(cg));else(function(ch){cb.push(ch);}(cg));}}else void 0;};_5=C.Scheduler=b_.Class({Fork:function(cb){var cc;cc=this;this.robin.push(cb);if(this.idle){this.idle=false;a.setTimeout(function(){cc.tick();},0);}},tick:function(){var cb,cc,cd;cc=this;cd=ca.now();cb=true;while(cb)if(this.robin.length===0){this.idle=true;cb=false;}else{(this.robin.shift())();ca.now()-cd>40?(a.setTimeout(function(){cc.tick();},0),cb=false):void 0;}}},g,_5);_5.New=b_.Ctor(function(){g.New.call(this);this.idle=true;this.robin=[];},_5);_7=A.NonStandardPromiseRejectionException=b_.Class({},_6,_7);_7.New=b_.Ctor(function(cb){this.message="Promise rejected";M.setPrototypeOf(this,_7.prototype);this.reason=cb;},_7);_8.$cctor=function(){_8.$cctor=a.ignore;_8.noneCT=R.New(false,[]);_8.scheduler=new _5.New();_8.defCTS=[new bh.New()];_8.Zero=C.Return();_8.GetCT=function(cb){cb.k({$:0,$0:cb.ct});};};_9.notPresent=function(){throw new bT.New();};_.Get=function(cb){return cb instanceof a.Array?_.ArrayEnumerator(cb):r.Equals(typeof cb,"string")?_.StringEnumerator(cb):cb.GetEnumerator();};_.ArrayEnumerator=function(cb){return new $.New(0,null,function(cc){var cd;cd=cc.s;return cd<m.length(cb)&&(cc.c=m.get(cb,cd),cc.s=cd+1,true);},void 0);};_.StringEnumerator=function(cb){return new $.New(0,null,function(cc){var cd;cd=cc.s;return cd<cb.length&&(cc.c=cb[cd],cc.s=cd+1,true);},void 0);};_.Get0=function(cb){return cb instanceof a.Array?_.ArrayEnumerator(cb):r.Equals(typeof cb,"string")?_.StringEnumerator(cb):"GetEnumerator0"in cb?cb.GetEnumerator0():cb.GetEnumerator();};$=_.T=b_.Class({MoveNext:function(){var cb;cb=this.n(this);this.e=cb?1:2;return cb;},Current:function(){return this.e===1?this.c:this.e===0?f.FailWith("Enumeration has not started. Call MoveNext."):f.FailWith("Enumeration already finished.");},Dispose:function(){if(this.d)this.d(this);}},g,$);$.New=b_.Ctor(function(cb,cc,cd,ce){g.New.call(this);this.s=cb;this.c=cc;this.n=cd;this.d=ce;this.e=0;},$);ba.$cctor=function(){ba.$cctor=a.ignore;ba.LoadedTemplates=new K.New$5();ba.LocalTemplatesLoaded=false;ba.GlobalHoles=new K.New$5();ba.TextHoleRE="\\${([^}]+)}";ba.RenderedFullDocTemplate=null;};bb.LinkElement=function(cb,cc){bb.InsertDoc(cb,cc,null);};bb.InsertDoc=function(cb,cc,cd){var ce,cf,cg;while(true)if(cc!=null&&cc.$==1)return bb.InsertNode(cb,cc.$0.El,cd);else if(cc!=null&&cc.$==2){ce=cc.$0;ce.Dirty=false;cc=ce.Current;}else if(cc==null)return cd;else if(cc!=null&&cc.$==4)return bb.InsertNode(cb,cc.$0.Text,cd);else if(cc!=null&&cc.$==5)return bb.InsertNode(cb,cc.$0,cd);else if(cc!=null&&cc.$==6)return m.foldBack(function(ch,ci){return(((b_.Curried3(function(cj,ck,cl){return ck==null||ck.constructor===M?bb.InsertDoc(cj,ck,cl):bb.InsertNode(cj,ck,cl);}))(cb))(ch))(ci);},cc.$0.Els,cd);else{cf=cc.$1;cg=cc.$0;cc=cg;cd=bb.InsertDoc(cb,cf,cd);}};bb.CreateRunState=function(cb,cc){return bJ.New(bK.get_Empty(),bb.CreateElemNode(cb,bu.EmptyAttr(),cc));};bb.PerformAnimatedUpdate=function(cb,cc,cd){var ce;return bp.get_UseAnimations()?(ce=null,C.Delay(function(){var cf,cg,ch;cf=bK.FindAll(cd);cg=bb.ComputeChangeAnim(cc,cf);ch=bb.ComputeEnterAnim(cc,cf);return C.Bind(bp.Play(bp.Append(cg,bb.ComputeExitAnim(cc,cf))),function(){return C.Bind(bb.SyncElemNodesNextFrame(cb,cc),function(){return C.Bind(bp.Play(ch),function(){cc.PreviousNodes=cf;return C.Return(null);});});});})):bb.SyncElemNodesNextFrame(cb,cc);};bb.PerformSyncUpdate=function(cb,cc,cd){var ce;ce=bK.FindAll(cd);bb.SyncElemNode(cb,cc.Top);cc.PreviousNodes=ce;};bb.InsertBeforeDelim=function(cb,cc){var cd,ce;cd=cb.parentNode;ce=self.document.createTextNode("");cd.insertBefore(ce,cb);bb.LinkPrevElement(cb,cc);return ce;};bb.InsertNode=function(cb,cc,cd){bn.InsertAt(cb,cd,cc);return cc;};bb.CreateElemNode=function(cb,cc,cd){var ce;bb.LinkElement(cb,cd);ce=bu.Insert(cb,cc);return bc.New(ce,cd,null,cb,bf.Int(),b_.GetOptional(ce.OnAfterRender));};bb.SyncElemNodesNextFrame=function(cb,cc){function cd(ce){a.requestAnimationFrame(function(){bb.SyncElemNode(cb,cc.Top);ce();});}return bq.BatchUpdatesEnabled()?C.FromContinuations(function(ce,cf,cg){return cd.apply(null,[ce,cf,cg]);}):(bb.SyncElemNode(cb,cc.Top),C.Return(null));};bb.ComputeExitAnim=function(cb,cc){return bp.Concat(m.map(function(cd){return bu.GetExitAnim(cd.Attr);},bK.ToArray(bK.Except(cc,bK.Filter(function(cd){return bu.HasExitAnim(cd.Attr);},cb.PreviousNodes)))));};bb.ComputeEnterAnim=function(cb,cc){return bp.Concat(m.map(function(cd){return bu.GetEnterAnim(cd.Attr);},bK.ToArray(bK.Except(cb.PreviousNodes,bK.Filter(function(cd){return bu.HasEnterAnim(cd.Attr);},cc)))));};bb.ComputeChangeAnim=function(cb,cc){var cd;function ce(cf){return bu.HasChangeAnim(cf.Attr);}cd=function(cf){return bK.Filter(ce,cf);};return bp.Concat(m.map(function(cf){return bu.GetChangeAnim(cf.Attr);},bK.ToArray(bK.Intersect(cd(cb.PreviousNodes),cd(cc)))));};bb.SyncElemNode=function(cb,cc){!cb?bb.SyncElement(cc):void 0;bb.Sync(cc.Children);bb.AfterRender(cc);};bb.CreateTextNode=function(){return{Text:self.document.createTextNode(""),Dirty:false,Value:""};};bb.UpdateTextNode=function(cb,cc){cb.Value=cc;cb.Dirty=true;};bb.LinkPrevElement=function(cb,cc){bb.InsertDoc(cb.parentNode,cc,cb);};bb.SyncElement=function(cb){function cc(cd){function ce(cf){var cg,ch,ci,cj;while(true){if(cf!=null&&cf.$==0){ch=cf.$1;ci=cf.$0;if(ce(ci))return true;else cf=ch;}else if(cf!=null&&cf.$==2){cj=cf.$0;if(cj.Dirty)return true;else cf=cj.Current;}else return cf!=null&&cf.$==6&&(cg=cf.$0,cg.Dirty||m.exists(cc,cg.Holes));}}return ce(cd.Children);}bu.Sync(cb.El,cb.Attr);if(cc(cb))bb.DoSyncElement(cb);};bb.Sync=function(cb){var cc,cd,ce,cf,cg;while(true){if(cb!=null&&cb.$==1)return bb.SyncElemNode(false,cb.$0);else if(cb!=null&&cb.$==2){ce=cb.$0;cb=ce.Current;}else if(cb==null)return null;else if(cb!=null&&cb.$==5)return null;else if(cb!=null&&cb.$==4){cc=cb.$0;return cc.Dirty?(cc.Text.nodeValue=cc.Value,cc.Dirty=false):null;}else if(cb!=null&&cb.$==6){cd=cb.$0;m.iter(function(ch){bb.SyncElemNode(false,ch);},cd.Holes);m.iter(function(ch){bu.Sync(ch[0],ch[1]);},cd.Attrs);return bb.AfterRender(cd);}else{cf=cb.$1;cg=cb.$0;bb.Sync(cg);cb=cf;}}};bb.AfterRender=function(cb){var cc;cc=b_.GetOptional(cb.Render);if(cc!=null&&cc.$==1){cc.$0(cb.El);b_.SetOptional(cb,"Render",null);}};bb.DoSyncElement=function(cb){var cc,cd,ce;function cf(cg,ch){var ci,cj,ck,cl;while(true){if(cg!=null&&cg.$==1)return cg.$0.El;else if(cg!=null&&cg.$==2){cj=cg.$0;if(cj.Dirty){cj.Dirty=false;return bb.InsertDoc(cc,cj.Current,ch);}else cg=cj.Current;}else if(cg==null)return ch;else if(cg!=null&&cg.$==4)return cg.$0.Text;else if(cg!=null&&cg.$==5)return cg.$0;else if(cg!=null&&cg.$==6){ci=cg.$0;ci.Dirty?ci.Dirty=false:void 0;return m.foldBack(function(cm,cn){return cm==null||cm.constructor===M?cf(cm,cn):cm;},ci.Els,ch);}else{ck=cg.$1;cl=cg.$0;cg=cl;ch=cf(ck,ch);}}}cc=cb.El;b0.Iter((cd=cb.El,function(cg){bn.RemoveNode(cd,cg);}),b0.Except(b0.DocChildren(cb),b0.Children(cb.El,b_.GetOptional(cb.Delimiters))));cf(cb.Children,(ce=b_.GetOptional(cb.Delimiters),ce!=null&&ce.$==1?ce.$0[1]:null));};bc=h.DocElemNode=b_.Class({Equals:function(cb){return this.ElKey===cb.ElKey;},GetHashCode:function(){return this.ElKey;}},null,bc);bc.New=function(cb,cc,cd,ce,cf,cg){var ch;return new bc((ch={Attr:cb,Children:cc,El:ce,ElKey:cf},(b_.SetOptional(ch,"Delimiters",cd),b_.SetOptional(ch,"Render",cg),ch)));};bf.Int=function(){bf.set_counter(bf.counter()+1);return bf.counter();};bf.set_counter=function(cb){bO.$cctor();bO.counter=cb;};bf.counter=function(){bO.$cctor();return bO.counter;};bg=b.OperationCanceledException=b_.Class({},_6,bg);bg.New=b_.Ctor(function(cb){bg.New$1.call(this,"The operation was canceled.",null,cb);},bg);bg.New$1=b_.Ctor(function(cb,cc,cd){this.message=cb;this.inner=cc;M.setPrototypeOf(this,bg.prototype);this.ct=cd;},bg);bh=b.CancellationTokenSource=b_.Class({},g,bh);bh.New=b_.Ctor(function(){g.New.call(this);this.c=false;this.pending=null;this.r=[];this.init=1;},bh);bj=h.Elt=b_.Class({},I,bj);bj.TreeNode=function(cb,cc){var cd,ce;function cf(cg,ch){return bu.Updates(ch);}cd=bG.Create(cc);return new bj.New$1({$:6,$0:cb},_1.Map2Unit((ce=m.map(function(cg){return cf(cg[0],cg[1]);},cb.Attrs),bF.TreeReduce(_1.Const(),_1.Map2Unit,ce)),cd.v),m.get(cb.Els,0),cd);};bj.New$1=b_.Ctor(function(cb,cc,cd,ce){I.New.call(this,cb,cc);this.docNode$1=cb;this.updates$1=cc;this.elt=cd;this.rvUpdates=ce;},bj);_1.Const=function(cb){var cc;cc=_4.New({$:0,$0:cb});return function(){return cc;};};_1.Sink=function(cb,cc){function cd(){_4.WhenRun(cc(),cb,function(){C.scheduler().Fork(cd);});}C.scheduler().Fork(cd);};_1.Map=function(cb,cc){return _1.CreateLazy(function(){return _4.Map(cb,cc());});};_1.Map3=function(cb,cc,cd,ce){return _1.CreateLazy(function(){return _4.Map3(cb,cc(),cd(),ce());});};_1.Sequence=function(cb){return _1.CreateLazy(function(){return _4.Sequence(T.map(function(cc){return cc();},cb));});};_1.Map2=function(cb,cc,cd){return _1.CreateLazy(function(){return _4.Map2(cb,cc(),cd());});};_1.Map2Unit=function(cb,cc){return _1.CreateLazy(function(){return _4.Map2Unit(cb(),cc());});};_1.CreateLazy=function(cb){var cc;cc={c:null,o:cb};return function(){var cd,ce;cd=cc.c;return cd===null?(cd=cc.o(),cc.c=cd,(ce=cd.s,ce!=null&&ce.$==0)?cc.o=null:_4.WhenObsoleteRun(cd,function(){cc.c=null;}),cd):cd;};};bl.convertTextNode=function(cb){var cc,cd,ce,cf,cg,ch;cc=null;cd=0;cf=cb.textContent;cg=new a.RegExp(H.TextHoleRE(),"g");while(cc=cg.exec(cf),cc!==null){cb.parentNode.insertBefore(self.document.createTextNode(bm.string(cf,{$:1,$0:cd},{$:1,$0:cg.lastIndex-m.get(cc,0).length-1})),cb);cd=cg.lastIndex;ch=self.document.createElement("span");ch.setAttribute("ws-replace",m.get(cc,1).toLowerCase());cb.parentNode.insertBefore(ch,cb);}cg.lastIndex=0;cb.textContent=bm.string(cf,{$:1,$0:cd},null);};bl.failNotLoaded=function(cb){b8.warn("Instantiating non-loaded template",cb);};bl.fillTextHole=function(cb,cc,cd){var ce;ce=cb.querySelector("[ws-replace]");return r.Equals(ce,null)?(b8.warn("Filling non-existent text hole",cd),null):(ce.parentNode.replaceChild(self.document.createTextNode(cc),ce),{$:1,$0:ce.getAttribute("ws-replace")});};bl.removeHolesExcept=function(cb,cc){function cd(ce){H.foreachNotPreserved(cb,"["+ce+"]",function(cf){if(!cc.Contains(cf.getAttribute(ce)))cf.removeAttribute(ce);});}cd("ws-attr");cd("ws-onafterrender");cd("ws-var");H.foreachNotPreserved(cb,"[ws-hole]",function(ce){if(!cc.Contains(ce.getAttribute("ws-hole"))){ce.removeAttribute("ws-hole");while(ce.hasChildNodes())ce.removeChild(ce.lastChild);}});H.foreachNotPreserved(cb,"[ws-replace]",function(ce){if(!cc.Contains(ce.getAttribute("ws-replace")))ce.parentNode.removeChild(ce);});H.foreachNotPreserved(cb,"[ws-on]",function(ce){ce.setAttribute("ws-on",bE.concat(" ",m.filter(function(cf){return cc.Contains(m.get(bE.SplitChars(cf,[":"],1),1));},bE.SplitChars(ce.getAttribute("ws-on"),[" "],1))));});H.foreachNotPreserved(cb,"[ws-attr-holes]",function(ce){var cf,cg,ch,ci,cj;cf=bE.SplitChars(ce.getAttribute("ws-attr-holes"),[" "],1);for(cg=0,ch=cf.length-1;cg<=ch;cg++){ci=m.get(cf,cg);ce.setAttribute(ci,(cj=new a.RegExp(H.TextHoleRE(),"g"),ce.getAttribute(ci).replace(cj,function(ck,cl){return cc.Contains(cl)?ck:"";})));}});};bl.fillInstanceAttrs=function(cb,cc){var cd,ce,cf,cg,ch;bl.convertAttrs(cc);cd=cc.nodeName.toLowerCase();ce=cb.querySelector("[ws-attr="+cd+"]");if(r.Equals(ce,null))b8.warn("Filling non-existent attr hole",cd);else{ce.removeAttribute("ws-attr");for(cf=0,cg=cc.attributes.length-1;cf<=cg;cf++){ch=cc.attributes.item(cf);if(ch.name=="class"&&ce.hasAttribute("class"))ce.setAttribute("class",ce.getAttribute("class")+" "+ch.nodeValue);else ce.setAttribute(ch.name,ch.nodeValue);}}};bl.mapHoles=function(cb,cc){function cd(ce){H.foreachNotPreserved(cb,"["+ce+"]",function(cf){var cg,ch;cg=(ch=null,[cc.TryGetValue(cf.getAttribute(ce).toLowerCase(),{get:function(){return ch;},set:function(ci){ch=ci;}}),ch]);if(cg[0])cf.setAttribute(ce,cg[1]);});}cd("ws-hole");cd("ws-replace");cd("ws-attr");cd("ws-onafterrender");cd("ws-var");H.foreachNotPreserved(cb,"[ws-on]",function(ce){ce.setAttribute("ws-on",bE.concat(" ",m.map(function(cf){var cg,ch,ci;cg=bE.SplitChars(cf,[":"],1);ch=(ci=null,[cc.TryGetValue(m.get(cg,1),{get:function(){return ci;},set:function(cj){ci=cj;}}),ci]);return ch[0]?m.get(cg,0)+":"+ch[1]:cf;},bE.SplitChars(ce.getAttribute("ws-on"),[" "],1))));});H.foreachNotPreserved(cb,"[ws-attr-holes]",function(ce){var cf,cg,ch;cf=bE.SplitChars(ce.getAttribute("ws-attr-holes"),[" "],1);for(cg=0,ch=cf.length-1;cg<=ch;cg++)(function(){var ci;function cj(ck,cl){var cm;cm=f.KeyValue(cl);return ck.replace(new a.RegExp("\\${"+cm[0]+"}","ig"),"${"+cm[1]+"}");}ci=m.get(cf,cg);return ce.setAttribute(ci,(((b_.Curried3(T.fold))(cj))(ce.getAttribute(ci)))(cc));}());});};bl.fill=function(cb,cc,cd){while(true)if(cb.hasChildNodes())cd=cc.insertBefore(cb.lastChild,cd);else return null;};bl.convertAttrs=function(cb){var cd,ce,cf,cg,ch,ci,cj,ck;function cc(cl){var cm;cm=cb.getAttribute(cl);if(cm==null);else cb.setAttribute(cl,cm.toLowerCase());}cd=cb.attributes;ce=[];cf=[];cg=[];for(ch=0,ci=cd.length-1;ch<=ci;ch++){cj=cd.item(ch);if(bE.StartsWith(cj.nodeName,"ws-on")&&cj.nodeName!="ws-onafterrender"&&cj.nodeName!="ws-on"){ce.push(cj.nodeName);cf.push(bm.string(cj.nodeName,{$:1,$0:"ws-on".length},null)+":"+cj.nodeValue.toLowerCase());}else!bE.StartsWith(cj.nodeName,"ws-")&&(new a.RegExp(H.TextHoleRE())).test(cj.nodeValue)?(cj.nodeValue=(ck=new a.RegExp(H.TextHoleRE(),"g"),cj.nodeValue.replace(ck,function(cl,cm){return"${"+cm.toLowerCase()+"}";})),cg.push(cj.nodeName)):void 0;}if(!(cf.length==0))cb.setAttribute("ws-on",bE.concat(" ",cf));if(!(cg.length==0))cb.setAttribute("ws-attr-holes",bE.concat(" ",cg));cc("ws-hole");cc("ws-replace");cc("ws-attr");cc("ws-onafterrender");cc("ws-var");m.iter(function(cl){cb.removeAttribute(cl);},ce);};bm.string=function(cb,cc,cd){var ce,cf;return cc==null?cd!=null&&cd.$==1?(ce=cd.$0,ce<0?"":cb.slice(0,ce+1)):"":cd==null?cb.slice(cc.$0):(cf=cd.$0,cf<0?"":cb.slice(cc.$0,cf+1));};bn.ParseHTMLIntoFakeRoot=function(cb){var cc,cd,ce,cf,cg;function ch(ci,cj){var ck;while(true)if(cj===0)return ci;else{ck=cj;ci=ci.lastChild;cj=ck-1;}}cc=self.document.createElement("div");return!bn.rhtml().test(cb)?(cc.appendChild(self.document.createTextNode(cb)),cc):(cd=(ce=bn.rtagName().exec(cb),r.Equals(ce,null)?"":m.get(ce,1).toLowerCase()),(cf=(cg=(bn.wrapMap())[cd],cg?cg:bn.defaultWrap()),(cc.innerHTML=cf[1]+cb.replace(bn.rxhtmlTag(),"<$1></$2>")+cf[2],ch(cc,cf[0]))));};bn.ChildrenArray=function(cb){var cc,cd,ce;cc=[];for(cd=0,ce=cb.childNodes.length-1;cd<=ce;cd++)cc.push(cb.childNodes[cd]);return cc;};bn.rhtml=function(){bP.$cctor();return bP.rhtml;};bn.wrapMap=function(){bP.$cctor();return bP.wrapMap;};bn.defaultWrap=function(){bP.$cctor();return bP.defaultWrap;};bn.rxhtmlTag=function(){bP.$cctor();return bP.rxhtmlTag;};bn.rtagName=function(){bP.$cctor();return bP.rtagName;};bn.IterSelector=function(cb,cc,cd){var ce,cf,cg;ce=cb.querySelectorAll(cc);for(cf=0,cg=ce.length-1;cf<=cg;cf++)cd(ce[cf]);};bn.IterSelectorDoc=function(cb,cc){var cd,ce,cf;cd=self.document.querySelectorAll(cb);for(ce=0,cf=cd.length-1;ce<=cf;ce++)cc(cd[ce]);};bn.InsertAt=function(cb,cc,cd){var ce;if(!(cd.parentNode===cb&&cc===(ce=cd.nextSibling,r.Equals(ce,null)?null:ce)))cb.insertBefore(cd,cc);};bn.RemoveNode=function(cb,cc){if(cc.parentNode===cb)cb.removeChild(cc);};T.insufficient=function(){return f.FailWith("The input sequence has an insufficient number of elements.");};T.nonNegative=function(){return f.FailWith("The input must be non-negative.");};bo=J.KeyCollection=b_.Class({GetEnumerator:function(){return _.Get(T.map(function(cb){return cb.K;},this.d));}},g,bo);bo.New=b_.Ctor(function(cb){g.New.call(this);this.d=cb;},bo);bp.get_UseAnimations=function(){return bL.UseAnimations();};bp.Play=function(cb){var cc;cc=null;return C.Delay(function(){return C.Bind(bp.Run(a.ignore,bL.Actions(cb)),function(){bL.Finalize(cb);return C.Return(null);});});};bp.Append=function(cb,cc){return{$:0,$0:bR.Append(cb.$0,cc.$0)};};bp.Run=function(cb,cc){var cd;function ce(cf){function cg(ch){return function(ci){var cj;cj=ci-ch;cc.Compute(cj);cb();return cj<=cd?void a.requestAnimationFrame(function(ck){(cg(ch))(ck);}):cf();};}a.requestAnimationFrame(function(ch){(cg(ch))(ch);});}cd=cc.Duration;return cd===0?C.Zero():C.FromContinuations(function(cf,cg,ch){return ce.apply(null,[cf,cg,ch]);});};bp.Concat=function(cb){return{$:0,$0:bR.Concat(T.map(bL.List,cb))};};bp.get_Empty=function(){return{$:0,$0:bR.Empty()};};bq.BatchUpdatesEnabled=function(){bM.$cctor();return bM.BatchUpdatesEnabled;};br.StartProcessor=function(cb){var cc;function cd(){var ce;ce=null;return C.Delay(function(){return C.Bind(cb,function(){var cf;cf=cc[0];return r.Equals(cf,1)?(cc[0]=0,C.Zero()):r.Equals(cf,2)?(cc[0]=1,cd()):C.Zero();});});}cc=[0];return function(){var ce;ce=cc[0];if(r.Equals(ce,0)){cc[0]=1;C.Start(cd(),null);}else r.Equals(ce,1)?cc[0]=2:void 0;};};bt.New=function(cb,cc,cd,ce){var cf;cf={DynElem:cb,DynFlags:cc,DynNodes:cd};b_.SetOptional(cf,"OnAfterRender",ce);return cf;};_4.Obsolete=function(cb){var cc,cd,ce,cf,cg;cd=cb.s;if(cd==null||(cd!=null&&cd.$==2?(cc=cd.$1,false):cd!=null&&cd.$==3?(cc=cd.$1,false):true))void 0;else{cb.s=null;for(ce=0,cf=m.length(cc)-1;ce<=cf;ce++){cg=m.get(cc,ce);if(typeof cg=="object")(function(ch){_4.Obsolete(ch);}(cg));else cg();}}};_4.New=function(cb){return{s:cb};};bu.Insert=function(cb,cc){var cd,ce,cf;function cg(ch){var ci,cj;while(true)if(!(ch===null)){if(ch!=null&&ch.$==1)return cd.push(ch.$0);else if(ch!=null&&ch.$==2){ci=ch.$1;cj=ch.$0;cg(cj);ch=ci;}else return ch!=null&&ch.$==3?ch.$0(cb):ch!=null&&ch.$==4?ce.push(ch.$0):null;}else return null;}cd=[];ce=[];cg(cc);cf=cd.slice(0);return bt.New(cb,bu.Flags(cc),cf,ce.length===0?null:{$:1,$0:function(ch){T.iter(function(ci){ci(ch);},ce);}});};bu.Updates=function(cb){return bF.MapTreeReduce(function(cc){return cc.NChanged();},_1.Const(),_1.Map2Unit,cb.DynNodes);};bu.Empty=function(cb){return bt.New(cb,0,[],null);};bu.Flags=function(cb){return cb!==null&&cb.hasOwnProperty("flags")?cb.flags:0;};bu.Static=function(cb){return new bz({$:3,$0:cb});};bu.Dynamic=function(cb,cc){return new bz({$:1,$0:new bS.New(cb,cc)});};bu.EmptyAttr=function(){bU.$cctor();return bU.EmptyAttr;};bu.HasExitAnim=function(cb){var cc;cc=2;return(cb.DynFlags&cc)===cc;};bu.GetExitAnim=function(cb){return bu.GetAnim(cb,function(cc,cd){return cc.NGetExitAnim(cd);});};bu.HasEnterAnim=function(cb){var cc;cc=1;return(cb.DynFlags&cc)===cc;};bu.GetEnterAnim=function(cb){return bu.GetAnim(cb,function(cc,cd){return cc.NGetEnterAnim(cd);});};bu.HasChangeAnim=function(cb){var cc;cc=4;return(cb.DynFlags&cc)===cc;};bu.GetChangeAnim=function(cb){return bu.GetAnim(cb,function(cc,cd){return cc.NGetChangeAnim(cd);});};bu.AppendTree=function(cb,cc){var cd;return cb===null?cc:cc===null?cb:(cd=new bz({$:2,$0:cb,$1:cc}),(bu.SetFlags(cd,bu.Flags(cb)|bu.Flags(cc)),cd));};bu.GetAnim=function(cb,cc){return bp.Concat(m.map(function(cd){return cc(cd,cb.DynElem);},cb.DynNodes));};bu.Sync=function(cb,cc){m.iter(function(cd){cd.NSync(cb);},cc.DynNodes);};bu.SetFlags=function(cb,cc){cb.flags=cc;};bv=t.Elt=b_.Class({get_Value:function(){return this.fillWith;},get_Name:function(){return this.name;}},o,bv);bw=t.Attribute=b_.Class({get_Value:function(){return this.fillWith;},get_Name:function(){return this.name;}},o,bw);bx=t.Event=b_.Class({get_Value:function(){return this.fillWith;},get_Name:function(){return this.name;}},o,bx);by.Handler=function(cb,cc){return bu.Static(function(cd){cd.addEventListener(cb,function(ce){return(cc(cd))(ce);},false);});};by.OnAfterRender=function(cb){return new bz({$:4,$0:cb});};by.Dynamic=function(cb,cc){return bu.Dynamic(cc,function(cd){return function(ce){return cd.setAttribute(cb,ce);};});};by.Value=function(cb){return by.ValueWith(bX.StringApply(),cb);};by.FloatValueUnchecked=function(cb){return by.ValueWith(bX.FloatApplyUnchecked(),cb);};by.Checked=function(cb){return by.ValueWith(bX.BoolCheckedApply(),cb);};by.DateTimeValue=function(cb){return by.ValueWith(bX.DateTimeApplyUnchecked(),cb);};by.FileValue=function(cb){return by.ValueWith(bX.FileApplyUnchecked(),cb);};by.ValueWith=function(cb,cc){var cd;cd=cb(cc);return bz.Append(bu.Static(cd[0]),by.DynamicCustom(cd[1],cd[2]));};by.DynamicCustom=function(cb,cc){return bu.Dynamic(cc,cb);};bz=h.AttrProxy=b_.Class({},null,bz);bz.Handler=function(cb,cc){return bz.HandlerImpl(cb,cc);};bz.Concat=function(cb){var cc;cc=bF.ofSeqNonCopying(cb);return bF.TreeReduce(bu.EmptyAttr(),bz.Append,cc);};bz.Create=function(cb,cc){return bu.Static(function(cd){cd.setAttribute(cb,cc);});};bz.HandlerImpl=function(cb,cc){return bu.Static(function(cd){cd.addEventListener(cb,function(ce){return(cc(cd))(ce);},false);});};bz.Append=function(cb,cc){return bu.AppendTree(cb,cc);};bA=t.AfterRender=b_.Class({get_Value:function(){return this.fillWith;},get_Name:function(){return this.name;}},o,bA);bB=t.AfterRenderQ=b_.Class({get_Value:function(){return this.fillWith;},get_Name:function(){return this.name;}},o,bB);bD=bC.T=b_.Class({GetEnumerator:function(){return new $.New(this,null,function(cb){var cc;cc=cb.s;return cc.$==0?false:(cb.c=cc.$0,cb.s=cc.$1,true);},void 0);}},null,bD);bD.Empty=new bD({$:0});bE.concat=function(cb,cc){return m.ofSeq(cc).join(cb);};bE.SplitChars=function(cb,cc,cd){return bE.Split(cb,new a.RegExp("["+bE.RegexEscape(cc.join(""))+"]"),cd);};bE.StartsWith=function(cb,cc){return cb.substring(0,cc.length)==cc;};bE.Split=function(cb,cc,cd){return cd===1?m.filter(function(ce){return ce!=="";},bE.SplitWith(cb,cc)):bE.SplitWith(cb,cc);};bE.RegexEscape=function(cb){return cb.replace(new a.RegExp("[-\\/\\\\^$*+?.()|[\\]{}]","g"),"\\$&");};bE.SplitWith=function(cb,cc){return cb.split(cc);};bE.forall=function(cb,cc){return T.forall(cb,bE.protect(cc));};bE.protect=function(cb){return cb==null?"":cb;};bF.TreeReduce=function(cb,cc,cd){var ce;function cf(cg){return function(ch){var ci,cj;switch(ch<=0?0:ch===1?cg>=0&&cg<ce?1:(ci=ch,2):(ci=ch,2)){case 0:return cb;case 1:return m.get(cd,cg);case 2:cj=ch/2>>0;return cc((cf(cg))(cj),(cf(cg+cj))(ch-cj));}};}ce=m.length(cd);return(cf(0))(ce);};bF.MapTreeReduce=function(cb,cc,cd,ce){var cf;function cg(ch){return function(ci){var cj,ck;switch(ci<=0?0:ci===1?ch>=0&&ch<cf?1:(cj=ci,2):(cj=ci,2)){case 0:return cc;case 1:return cb(m.get(ce,ch));case 2:ck=ci/2>>0;return cd((cg(ch))(ck),(cg(ch+ck))(ci-ck));}};}cf=m.length(ce);return(cg(0))(cf);};bF.ofSeqNonCopying=function(cb){var cc,cd;if(cb instanceof a.Array)return cb;else if(cb instanceof bD)return m.ofList(cb);else if(cb===null)return[];else{cc=[];cd=_.Get(cb);try{while(cd.MoveNext())cc.push(cd.Current());return cc;}finally{if(typeof cd=="object"&&"Dispose"in cd)cd.Dispose();}}};bG=h.Updates=b_.Class({},null,bG);bG.Create=function(cb){var cc;cc=null;cc=bG.New(cb,null,function(){var cd;cd=cc.s;return cd===null?(cd=_4.Copy(cc.c()),cc.s=cd,_4.WhenObsoleteRun(cd,function(){cc.s=null;}),cd):cd;});return cc;};bG.New=function(cb,cc,cd){return new bG({c:cb,s:cc,v:cd});};bH=J.ValueCollection=b_.Class({GetEnumerator:function(){return _.Get(T.map(function(cb){return cb.V;},this.d));}},g,bH);bH.New=b_.Ctor(function(cb){g.New.call(this);this.d=cb;},bH);bJ.New=function(cb,cc){return{PreviousNodes:cb,Top:cc};};bK.get_Empty=function(){return{$:0,$0:new S.New$3()};};bK.FindAll=function(cb){var cc;function cd(cg,ch){var ci,cj,ck,cl,cm;while(true)switch(cg){case 0:if(ch!=null&&ch.$==0){cj=ch.$1;ck=ch.$0;cd(0,ck);ch=cj;}else if(ch!=null&&ch.$==1){cl=ch.$0;ch=cl;cg=1;}else if(ch!=null&&ch.$==2){cm=ch.$0;ch=cm.Current;}else return ch!=null&&ch.$==6?(ci=ch.$0.Holes,(function(cn){return function(co){m.iter(cn,co);};}(cf))(ci)):null;break;case 1:cc.push(ch);ch=ch.Children;cg=0;break;}}function ce(cg){return cd(0,cg);}function cf(cg){return cd(1,cg);}cc=[];ce(cb);return{$:0,$0:new S.New$2(cc)};};bK.Filter=function(cb,cc){return{$:0,$0:bW.Filter(cb,cc.$0)};};bK.Except=function(cb,cc){return{$:0,$0:bW.Except(cb.$0,cc.$0)};};bK.ToArray=function(cb){return bW.ToArray(cb.$0);};bK.Intersect=function(cb,cc){return{$:0,$0:bW.Intersect(cb.$0,cc.$0)};};bL.UseAnimations=function(){bQ.$cctor();return bQ.UseAnimations;};bL.Actions=function(cb){return bL.ConcatActions(m.choose(function(cc){return cc.$==1?{$:1,$0:cc.$0}:null;},bR.ToArray(cb.$0)));};bL.Finalize=function(cb){m.iter(function(cc){if(cc.$==0)cc.$0();},bR.ToArray(cb.$0));};bL.ConcatActions=function(cb){var cc,cd,ce,cf;cc=bF.ofSeqNonCopying(cb);cd=m.length(cc);return cd===0?bL.Const():cd===1?m.get(cc,0):(ce=T.max(T.map(function(cg){return cg.Duration;},cc)),(cf=m.map(function(cg){return bL.Prolong(ce,cg);},cc),bL.Def(ce,function(cg){m.iter(function(ch){ch.Compute(cg);},cf);})));};bL.List=function(cb){return cb.$0;};bL.Const=function(cb){return bL.Def(0,function(){return cb;});};bL.Def=function(cb,cc){return{Compute:cc,Duration:cb};};bL.Prolong=function(cb,cc){var cd,ce,cf;cd=cc.Compute;ce=cc.Duration;cf=b3.Create(function(){return cc.Compute(cc.Duration);});return{Compute:function(cg){return cg>=ce?cf.f():cd(cg);},Duration:cb};};bM.$cctor=function(){bM.$cctor=a.ignore;bM.BatchUpdatesEnabled=true;};bN.concat=function(cb){var cc,cd;cc=[];for(var ce in cb)cc.push.apply(cc,cb[ce]);return cc;};bO.$cctor=function(){bO.$cctor=a.ignore;bO.counter=0;};bP.$cctor=function(){var cb;bP.$cctor=a.ignore;bP.rxhtmlTag=new a.RegExp("<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\\w:]+)[^>]*)\\/>","gi");bP.rtagName=new a.RegExp("<([\\w:]+)");bP.rhtml=new a.RegExp("<|&#?\\w+;");bP.wrapMap=(cb=[1,"<table>","</table>"],{option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:cb,tbody:cb,tfoot:cb,tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><colgroup>","</colgoup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"]});bP.defaultWrap=[0,"",""];};bQ.$cctor=function(){bQ.$cctor=a.ignore;bQ.CubicInOut=bV.Custom(function(cb){var cc;cc=cb*cb;return 3*cc-2*(cc*cb);});bQ.UseAnimations=true;};bR.Append=function(cb,cc){return cb.$==0?cc:cc.$==0?cb:{$:2,$0:cb,$1:cc};};bR.ToArray=function(cb){var cc;function cd(ce){var cf,cg;while(true)if(ce.$==1)return cc.push(ce.$0);else if(ce.$==2){cf=ce.$1;cg=ce.$0;cd(cg);ce=cf;}else return ce.$==3?m.iter(function(ch){cc.push(ch);},ce.$0):null;}cc=[];cd(cb);return cc.slice(0);};bR.Concat=function(cb){var cc;cc=bF.ofSeqNonCopying(cb);return bF.TreeReduce(bR.Empty(),bR.Append,cc);};bR.Empty=function(){b4.$cctor();return b4.Empty;};bS=h.DynamicAttrNode=b_.Class({NChanged:function(){return this.updates;},NGetExitAnim:function(cb){return bp.get_Empty();},NGetEnterAnim:function(cb){return bp.get_Empty();},NGetChangeAnim:function(cb){return bp.get_Empty();},NSync:function(cb){if(this.dirty){(this.push(cb))(this.value);this.dirty=false;}}},g,bS);bS.New=b_.Ctor(function(cb,cc){var cd;cd=this;g.New.call(this);this.push=cc;this.value=void 0;this.dirty=false;this.updates=_1.Map(function(ce){cd.value=ce;cd.dirty=true;},cb);},bS);bT=b.KeyNotFoundException=b_.Class({},_6,bT);bT.New=b_.Ctor(function(){bT.New$1.call(this,"The given key was not present in the dictionary.");},bT);bT.New$1=b_.Ctor(function(cb){this.message=cb;M.setPrototypeOf(this,bT.prototype);},bT);bU.$cctor=function(){var cb,cc,cd,ce,cf,cg,ch,ci,cj,ck,cl,cm,cn,co;bU.$cctor=a.ignore;bU.EmptyAttr=null;bU.BoolCheckedApply=function(cp){function cq(cr,cs){return cs!=null&&cs.$==1?void(cr.checked=cs.$0):null;}return[function(cr){cr.addEventListener("change",function(){return cp.Get()!=cr.checked?cp.Set(cr.checked):null;});},function(cr){return function(cs){return cq(cr,cs);};},_1.Map(function(cr){return{$:1,$0:cr};},cp.get_View())];};bU.StringSet=function(cp){return function(cq){cp.value=cq;};};bU.StringGet=function(cp){return{$:1,$0:cp.value};};bU.StringApply=(cb=bX.StringGet(),(cc=bX.StringSet(),function(cp){return bX.ApplyValue(cb,cc,cp);}));bU.DateTimeSetUnchecked=function(cp){return function(cq){cp.value=(new ca(cq)).toLocaleString();};};bU.DateTimeGetUnchecked=function(cp){var cq,cr,cs,ct;cq=cp.value;return bY.isBlank(cq)?{$:1,$0:-8640000000000000}:(cr=(cs=0,[(ct=b2.TryParse(cq),ct!=null&&ct.$==1&&(cs=ct.$0,true)),cs]),cr[0]?{$:1,$0:cr[1]}:null);};bU.DateTimeApplyUnchecked=(cd=bX.DateTimeGetUnchecked(),(ce=bX.DateTimeSetUnchecked(),function(cp){return bX.ApplyValue(cd,ce,cp);}));bU.FileSetUnchecked=function(){return function(){return null;};};bU.FileGetUnchecked=function(cp){var cq;cq=cp.files;return{$:1,$0:m.ofSeq(T.delay(function(){return T.map(function(cr){return cq.item(cr);},f.range(0,cq.length-1));}))};};bU.FileApplyUnchecked=(cf=bX.FileGetUnchecked(),(cg=bX.FileSetUnchecked(),function(cp){return bX.FileApplyValue(cf,cg,cp);}));bU.IntSetUnchecked=function(cp){return function(cq){cp.value=a.String(cq);};};bU.IntGetUnchecked=function(cp){var cq,cr;cq=cp.value;return bY.isBlank(cq)?{$:1,$0:0}:(cr=+cq,cr!==cr>>0?null:{$:1,$0:cr});};bU.IntApplyUnchecked=(ch=bX.IntGetUnchecked(),(ci=bX.IntSetUnchecked(),function(cp){return bX.ApplyValue(ch,ci,cp);}));bU.IntSetChecked=function(cp){return function(cq){var cr;cr=cq.get_Input();return cp.value!=cr?void(cp.value=cr):null;};};bU.IntGetChecked=function(cp){var cq,cr,cs;cq=cp.value;return{$:1,$0:bY.isBlank(cq)?(cp.checkValidity?cp.checkValidity():true)?new bZ({$:2,$0:cq}):new bZ({$:1,$0:cq}):(cr=(cs=0,[_2.TryParseInt32(cq,{get:function(){return cs;},set:function(ct){cs=ct;}}),cs]),cr[0]?new bZ({$:0,$0:cr[1],$1:cq}):new bZ({$:1,$0:cq}))};};bU.IntApplyChecked=(cj=bX.IntGetChecked(),(ck=bX.IntSetChecked(),function(cp){return bX.ApplyValue(cj,ck,cp);}));bU.FloatSetUnchecked=function(cp){return function(cq){cp.value=a.String(cq);};};bU.FloatGetUnchecked=function(cp){var cq,cr;cq=cp.value;return bY.isBlank(cq)?{$:1,$0:0}:(cr=+cq,a.isNaN(cr)?null:{$:1,$0:cr});};bU.FloatApplyUnchecked=(cl=bX.FloatGetUnchecked(),(cm=bX.FloatSetUnchecked(),function(cp){return bX.ApplyValue(cl,cm,cp);}));bU.FloatSetChecked=function(cp){return function(cq){var cr;cr=cq.get_Input();return cp.value!=cr?void(cp.value=cr):null;};};bU.FloatGetChecked=function(cp){var cq,cr;cq=cp.value;return{$:1,$0:bY.isBlank(cq)?(cp.checkValidity?cp.checkValidity():true)?new bZ({$:2,$0:cq}):new bZ({$:1,$0:cq}):(cr=+cq,a.isNaN(cr)?new bZ({$:1,$0:cq}):new bZ({$:0,$0:cr,$1:cq}))};};bU.FloatApplyChecked=(cn=bX.FloatGetChecked(),(co=bX.FloatSetChecked(),function(cp){return bX.ApplyValue(cn,co,cp);}));};bV=h.Easing=b_.Class({},g,bV);bV.Custom=function(cb){return new bV.New(cb);};bV.New=b_.Ctor(function(cb){g.New.call(this);this.transformTime=cb;},bV);bW.Filter=function(cb,cc){return new S.New$2(m.filter(cb,bW.ToArray(cc)));};bW.Except=function(cb,cc){var cd;cd=new S.New$2(bW.ToArray(cc));cd.ExceptWith(bW.ToArray(cb));return cd;};bW.ToArray=function(cb){var cc;cc=m.create(cb.Count(),void 0);cb.CopyTo(cc,0);return cc;};bW.Intersect=function(cb,cc){var cd;cd=new S.New$2(bW.ToArray(cb));cd.IntersectWith(bW.ToArray(cc));return cd;};bC.head=function(cb){return cb.$==1?cb.$0:bC.listEmpty();};bC.tail=function(cb){return cb.$==1?cb.$1:bC.listEmpty();};bC.listEmpty=function(){return f.FailWith("The input list was empty.");};bX.ApplyValue=function(cb,cc,cd){var ce;function cf(cg,ch){return ch==null?null:cg(ch.$0);}ce=null;return[function(cg){function ch(){cd.UpdateMaybe(function(ci){var cj;ce=cb(cg);return ce!=null&&ce.$==1&&(!r.Equals(ce.$0,ci)&&(cj=[ce,ce.$0],true))?cj[0]:null;});}cg.addEventListener("change",ch);cg.addEventListener("input",ch);cg.addEventListener("keypress",ch);},function(cg){var ch;ch=cc(cg);return function(ci){return cf(ch,ci);};},_1.Map(function(cg){var ch;return ce!=null&&ce.$==1&&(r.Equals(ce.$0,cg)&&(ch=ce.$0,true))?null:{$:1,$0:cg};},cd.get_View())];};bX.StringSet=function(){bU.$cctor();return bU.StringSet;};bX.StringGet=function(){bU.$cctor();return bU.StringGet;};bX.DateTimeSetUnchecked=function(){bU.$cctor();return bU.DateTimeSetUnchecked;};bX.DateTimeGetUnchecked=function(){bU.$cctor();return bU.DateTimeGetUnchecked;};bX.FileApplyValue=function(cb,cc,cd){var ce;function cf(cg,ch){return ch==null?null:cg(ch.$0);}ce=null;return[function(cg){cg.addEventListener("change",function(){cd.UpdateMaybe(function(ch){var ci;ce=cb(cg);return ce!=null&&ce.$==1&&(ce.$0!==ch&&(ci=[ce,ce.$0],true))?ci[0]:null;});});},function(cg){var ch;ch=cc(cg);return function(ci){return cf(ch,ci);};},_1.Map(function(cg){var ch;return ce!=null&&ce.$==1&&(r.Equals(ce.$0,cg)&&(ch=ce.$0,true))?null:{$:1,$0:cg};},cd.get_View())];};bX.FileSetUnchecked=function(){bU.$cctor();return bU.FileSetUnchecked;};bX.FileGetUnchecked=function(){bU.$cctor();return bU.FileGetUnchecked;};bX.IntSetUnchecked=function(){bU.$cctor();return bU.IntSetUnchecked;};bX.IntGetUnchecked=function(){bU.$cctor();return bU.IntGetUnchecked;};bX.IntSetChecked=function(){bU.$cctor();return bU.IntSetChecked;};bX.IntGetChecked=function(){bU.$cctor();return bU.IntGetChecked;};bX.FloatSetUnchecked=function(){bU.$cctor();return bU.FloatSetUnchecked;};bX.FloatGetUnchecked=function(){bU.$cctor();return bU.FloatGetUnchecked;};bX.FloatSetChecked=function(){bU.$cctor();return bU.FloatSetChecked;};bX.FloatGetChecked=function(){bU.$cctor();return bU.FloatGetChecked;};bX.StringApply=function(){bU.$cctor();return bU.StringApply;};bX.FloatApplyUnchecked=function(){bU.$cctor();return bU.FloatApplyUnchecked;};bX.BoolCheckedApply=function(){bU.$cctor();return bU.BoolCheckedApply;};bX.DateTimeApplyUnchecked=function(){bU.$cctor();return bU.DateTimeApplyUnchecked;};bX.FileApplyUnchecked=function(){bU.$cctor();return bU.FileApplyUnchecked;};bY.isBlank=function(cb){return bE.forall(b1.IsWhiteSpace,cb);};bZ=h.CheckedInput=b_.Class({get_Input:function(){return this.$==1?this.$0:this.$==2?this.$0:this.$1;}},null,bZ);b0.Children=function(cb,cc){var cd,ce,cf;if(cc!=null&&cc.$==1){cf=[];cd=cc.$0[0].nextSibling;while(cd!==cc.$0[1]){cf.push(cd);cd=cd.nextSibling;}return{$:0,$0:cf};}else return{$:0,$0:m.init(cb.childNodes.length,(ce=cb.childNodes,function(cg){return ce[cg];}))};};b0.Except=function(cb,cc){var cd;cd=cb.$0;return{$:0,$0:m.filter(function(ce){return m.forall(function(cf){return!(ce===cf);},cd);},cc.$0)};};b0.Iter=function(cb,cc){m.iter(cb,cc.$0);};b0.DocChildren=function(cb){var cc;function cd(ce){var cf,cg,ch,ci;while(true){if(ce!=null&&ce.$==2){cg=ce.$0;ce=cg.Current;}else if(ce!=null&&ce.$==1)return cc.push(ce.$0.El);else if(ce==null)return null;else if(ce!=null&&ce.$==5)return cc.push(ce.$0);else if(ce!=null&&ce.$==4)return cc.push(ce.$0.Text);else if(ce!=null&&ce.$==6){cf=ce.$0.Els;return(function(cj){return function(ck){m.iter(cj,ck);};}(function(cj){if(cj==null||cj.constructor===M)cd(cj);else cc.push(cj);}))(cf);}else{ch=ce.$1;ci=ce.$0;cd(ci);ce=ch;}}}cc=[];cd(cb.Children);return{$:0,$0:bF.ofSeqNonCopying(cc)};};b1.IsWhiteSpace=function(cb){return cb.match(new a.RegExp("\\s"))!==null;};b2.TryParse=function(cb){var cc;cc=ca.parse(cb);return a.isNaN(cc)?null:{$:1,$0:cc};};_2.TryParse=function(cb,cc,cd,ce){var cf,cg;cf=+cb;cg=cf===cf-cf%1&&cf>=cc&&cf<=cd;if(cg)ce.set(cf);return cg;};b3.Create=function(cb){return b7.New(false,cb,b3.forceLazy);};b3.forceLazy=function(){var cb;cb=this.v();this.c=true;this.v=cb;this.f=b3.cachedLazy;return cb;};b3.cachedLazy=function(){return this.v;};b4.$cctor=function(){b4.$cctor=a.ignore;b4.Empty={$:0};};b5.Clear=function(cb){cb.splice(0,m.length(cb));};b7.New=function(cb,cc,cd){return{c:cb,v:cc,f:cd};};b_.OnLoad(function(){e.Main();});}(self));


if (typeof WebSharper !=='undefined') {
  WebSharper.Runtime.ScriptBasePath = '/Content/';
  WebSharper.Runtime.Start();
}
